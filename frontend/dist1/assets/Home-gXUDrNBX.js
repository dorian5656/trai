import{d as mo,O as go,E as ho,a as Ue,b as bo,c as _o,u as wo,P as pe,M as yo,C as Pe,e as So,S as ko,f as Co,g as Eo,h as Io,i as To,j as $o,k as Ro,l as Ne,r as Fo,m as Oo}from"./dify-Dm1rxCaI.js";import{f as _e,g as X,d as H,i as V,h as fe,t as Lo,j as Ve,k as me,l as ee,e as b,m as U,w as R,n as le,p as h,q as de,r as j,s as o,v as oe,x as ie,T as Mo,y,z as Po,A as D,c as L,B as F,F as re,C as ce,D as No,E as ve,G as ae,H as Do,o as $e,I as ge,J as zo,K as J,L as We,M as x,N as Bo,O as Te,P as De,Q as te,R as Ao,S as Ye,U as we,V as Q,W as Ho,X as K,Y as Ko,Z as Go,$ as Uo,a0 as he,a1 as Vo,a2 as Re,a3 as je,a4 as Wo,a5 as Je,a6 as Yo,a7 as Xe,a8 as jo,a9 as ue,aa as qe,ab as ze,ac as Qe,ad as be,ae as Y,_ as Ze,u as Jo,af as Xo,ag as Ie,ah as qo,ai as ne,a as Qo,aj as Zo,ak as xo,al as et}from"./index-LA8rxSg-.js";import{u as ot}from"./github-dark-BiOJF1sg.js";const se=4,tt={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},nt=({move:e,size:l,bar:t})=>({[t.size]:l,transform:`translate${t.axis}(${e}%)`}),Fe=Symbol("scrollbarContextKey"),st=_e({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),lt="Thumb",it=H({__name:"thumb",props:st,setup(e){const l=e,t=V(Fe),n=fe("scrollbar");t||Lo(lt,"can not inject scrollbar context");const d=y(),a=y(),f=y({}),p=y(!1);let v=!1,m=!1,g=0,c=0,r=Po?document.onselectstart:null;const s=D(()=>tt[l.vertical?"vertical":"horizontal"]),k=D(()=>nt({size:l.size,move:l.move,bar:s.value})),M=D(()=>d.value[s.value.offset]**2/t.wrapElement[s.value.scrollSize]/l.ratio/a.value[s.value.offset]),_=C=>{var B;if(C.stopPropagation(),C.ctrlKey||[1,2].includes(C.button))return;(B=window.getSelection())==null||B.removeAllRanges(),P(C);const I=C.currentTarget;I&&(f.value[s.value.axis]=I[s.value.offset]-(C[s.value.client]-I.getBoundingClientRect()[s.value.direction]))},T=C=>{if(!a.value||!d.value||!t.wrapElement)return;const B=Math.abs(C.target.getBoundingClientRect()[s.value.direction]-C[s.value.client]),I=a.value[s.value.offset]/2,u=(B-I)*100*M.value/d.value[s.value.offset];t.wrapElement[s.value.scroll]=u*t.wrapElement[s.value.scrollSize]/100},P=C=>{C.stopImmediatePropagation(),v=!0,g=t.wrapElement.scrollHeight,c=t.wrapElement.scrollWidth,document.addEventListener("mousemove",O),document.addEventListener("mouseup",E),r=document.onselectstart,document.onselectstart=()=>!1},O=C=>{if(!d.value||!a.value||v===!1)return;const B=f.value[s.value.axis];if(!B)return;const I=(d.value.getBoundingClientRect()[s.value.direction]-C[s.value.client])*-1,u=a.value[s.value.offset]-B,$=(I-u)*100*M.value/d.value[s.value.offset];s.value.scroll==="scrollLeft"?t.wrapElement[s.value.scroll]=$*c/100:t.wrapElement[s.value.scroll]=$*g/100},E=()=>{v=!1,f.value[s.value.axis]=0,document.removeEventListener("mousemove",O),document.removeEventListener("mouseup",E),G(),m&&(p.value=!1)},z=()=>{m=!1,p.value=!!l.size},W=()=>{m=!0,p.value=v};Ve(()=>{G(),document.removeEventListener("mouseup",E)});const G=()=>{document.onselectstart!==r&&(document.onselectstart=r)};return me(ee(t,"scrollbarElement"),"mousemove",z),me(ee(t,"scrollbarElement"),"mouseleave",W),(C,B)=>(b(),U(Mo,{name:o(n).b("fade"),persisted:""},{default:R(()=>[le(h("div",{ref_key:"instance",ref:d,class:j([o(n).e("bar"),o(n).is(o(s).key)]),onMousedown:T,onClick:de(()=>{},["stop"])},[h("div",{ref_key:"thumb",ref:a,class:j(o(n).e("thumb")),style:oe(o(k)),onMousedown:_},null,38)],42,["onClick"]),[[ie,C.always||p.value]])]),_:1},8,["name"]))}});var Be=X(it,[["__file","thumb.vue"]]);const at=_e({always:{type:Boolean,default:!0},minSize:{type:Number,required:!0}}),rt=H({__name:"bar",props:at,setup(e,{expose:l}){const t=e,n=V(Fe),d=y(0),a=y(0),f=y(""),p=y(""),v=y(1),m=y(1);return l({handleScroll:r=>{if(r){const s=r.offsetHeight-se,k=r.offsetWidth-se;a.value=r.scrollTop*100/s*v.value,d.value=r.scrollLeft*100/k*m.value}},update:()=>{const r=n?.wrapElement;if(!r)return;const s=r.offsetHeight-se,k=r.offsetWidth-se,M=s**2/r.scrollHeight,_=k**2/r.scrollWidth,T=Math.max(M,t.minSize),P=Math.max(_,t.minSize);v.value=M/(s-M)/(T/(s-T)),m.value=_/(k-_)/(P/(k-P)),p.value=T+se<s?`${T}px`:"",f.value=P+se<k?`${P}px`:""}}),(r,s)=>(b(),L(re,null,[F(Be,{move:d.value,ratio:m.value,size:f.value,always:r.always},null,8,["move","ratio","size","always"]),F(Be,{move:a.value,ratio:v.value,size:p.value,vertical:"",always:r.always},null,8,["move","ratio","size","always"])],64))}});var ct=X(rt,[["__file","bar.vue"]]);const ut=_e({distance:{type:Number,default:0},height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:Boolean,wrapStyle:{type:ve([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20},tabindex:{type:[String,Number],default:void 0},id:String,role:String,...No(["ariaLabel","ariaOrientation"])}),dt={"end-reached":e=>["left","right","top","bottom"].includes(e),scroll:({scrollTop:e,scrollLeft:l})=>[e,l].every(ce)},ft="ElScrollbar",pt=H({name:ft}),vt=H({...pt,props:ut,emits:dt,setup(e,{expose:l,emit:t}){const n=e,d=fe("scrollbar");let a,f,p,v=0,m=0,g="";const c={bottom:!1,top:!1,right:!1,left:!1},r=y(),s=y(),k=y(),M=y(),_=D(()=>{const u={},$=Te(n.height),S=Te(n.maxHeight);return $&&(u.height=$),S&&(u.maxHeight=S),[n.wrapStyle,u]}),T=D(()=>[n.wrapClass,d.e("wrap"),{[d.em("wrap","hidden-default")]:!n.native}]),P=D(()=>[d.e("view"),n.viewClass]),O=u=>{var $;return($=c[u])!=null?$:!1},E={top:"bottom",bottom:"top",left:"right",right:"left"},z=u=>{const $=E[g];if(!$)return;const S=u[g],Z=u[$];S&&!c[g]&&(c[g]=!0),!Z&&c[$]&&(c[$]=!1)},W=()=>{var u;if(s.value){(u=M.value)==null||u.handleScroll(s.value);const $=v,S=m;v=s.value.scrollTop,m=s.value.scrollLeft;const Z={bottom:v+s.value.clientHeight>=s.value.scrollHeight-n.distance,top:v<=n.distance&&$!==0,right:m+s.value.clientWidth>=s.value.scrollWidth-n.distance&&S!==m,left:m<=n.distance&&S!==0};if(t("scroll",{scrollTop:v,scrollLeft:m}),$!==v&&(g=v>$?"bottom":"top"),S!==m&&(g=m>S?"right":"left"),n.distance>0){if(O(g))return;z(Z)}Z[g]&&t("end-reached",g)}};function G(u,$){Bo(u)?s.value.scrollTo(u):ce(u)&&ce($)&&s.value.scrollTo(u,$)}const C=u=>{ce(u)&&(s.value.scrollTop=u)},B=u=>{ce(u)&&(s.value.scrollLeft=u)},I=()=>{var u;(u=M.value)==null||u.update(),c[g]=!1};return ae(()=>n.noresize,u=>{u?(a?.(),f?.(),p?.()):({stop:a}=De(k,I),{stop:f}=De(s,I),p=me("resize",I))},{immediate:!0}),ae(()=>[n.maxHeight,n.height],()=>{n.native||ge(()=>{var u;I(),s.value&&((u=M.value)==null||u.handleScroll(s.value))})}),te(Fe,Ao({scrollbarElement:r,wrapElement:s})),Do(()=>{s.value&&(s.value.scrollTop=v,s.value.scrollLeft=m)}),$e(()=>{n.native||ge(()=>{I()})}),zo(()=>I()),l({wrapRef:s,update:I,scrollTo:G,setScrollTop:C,setScrollLeft:B,handleScroll:W}),(u,$)=>(b(),L("div",{ref_key:"scrollbarRef",ref:r,class:j(o(d).b())},[h("div",{ref_key:"wrapRef",ref:s,class:j(o(T)),style:oe(o(_)),tabindex:u.tabindex,onScroll:W},[(b(),U(We(u.tag),{id:u.id,ref_key:"resizeRef",ref:k,class:j(o(P)),style:oe(u.viewStyle),role:u.role,"aria-label":u.ariaLabel,"aria-orientation":u.ariaOrientation},{default:R(()=>[J(u.$slots,"default")]),_:3},8,["id","class","style","role","aria-label","aria-orientation"]))],46,["tabindex"]),u.native?x("v-if",!0):(b(),U(ct,{key:0,ref_key:"barRef",ref:M,always:u.always,"min-size":u.minSize},null,8,["always","min-size"]))],2))}});var mt=X(vt,[["__file","scrollbar.vue"]]);const gt=Ye(mt),ht=H({inheritAttrs:!1});function bt(e,l,t,n,d,a){return J(e.$slots,"default")}var _t=X(ht,[["render",bt],["__file","collection.vue"]]);const wt=H({name:"ElCollectionItem",inheritAttrs:!1});function yt(e,l,t,n,d,a){return J(e.$slots,"default")}var St=X(wt,[["render",yt],["__file","collection-item.vue"]]);const xe="data-el-collection-item",kt=e=>{const l=`El${e}Collection`,t=`${l}Item`,n=Symbol(l),d=Symbol(t),a={..._t,name:l,setup(){const p=y(),v=new Map;te(n,{itemMap:v,getItems:()=>{const g=o(p);if(!g)return[];const c=Array.from(g.querySelectorAll(`[${xe}]`));return[...v.values()].sort((s,k)=>c.indexOf(s.ref)-c.indexOf(k.ref))},collectionRef:p})}},f={...St,name:t,setup(p,{attrs:v}){const m=y(),g=V(n,void 0);te(d,{collectionItemRef:m}),$e(()=>{const c=o(m);c&&g.itemMap.set(c,{ref:c,...v})}),Ve(()=>{const c=o(m);g.itemMap.delete(c)})}};return{COLLECTION_INJECTION_KEY:n,COLLECTION_ITEM_INJECTION_KEY:d,ElCollection:a,ElCollectionItem:f}},Ct=_e({style:{type:ve([String,Array,Object])},currentTabId:{type:ve(String)},defaultCurrentTabId:String,loop:Boolean,dir:{type:String,values:["ltr","rtl"],default:"ltr"},orientation:{type:ve(String)},onBlur:Function,onFocus:Function,onMousedown:Function}),{ElCollection:Et,ElCollectionItem:It,COLLECTION_INJECTION_KEY:eo,COLLECTION_ITEM_INJECTION_KEY:Tt}=kt("RovingFocusGroup"),Oe=Symbol("elRovingFocusGroup"),oo=Symbol("elRovingFocusGroupItem"),$t={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"},Rt=(e,l)=>e,Ft=(e,l,t)=>{const n=we(e),d=Rt(n);return $t[d]},Ot=(e,l)=>e.map((t,n)=>e[(n+l)%e.length]),Ae=e=>{const{activeElement:l}=document;for(const t of e)if(t===l||(t.focus(),l!==document.activeElement))return},He="currentTabIdChange",Ke="rovingFocusGroup.entryFocus",Lt={bubbles:!1,cancelable:!0},Mt=H({name:"ElRovingFocusGroupImpl",inheritAttrs:!1,props:Ct,emits:[He,"entryFocus"],setup(e,{emit:l}){var t;const n=y((t=e.currentTabId||e.defaultCurrentTabId)!=null?t:null),d=y(!1),a=y(!1),f=y(),{getItems:p}=V(eo,void 0),v=D(()=>[{outline:"none"},e.style]),m=_=>{l(He,_)},g=()=>{d.value=!0},c=Q(_=>{var T;(T=e.onMousedown)==null||T.call(e,_)},()=>{a.value=!0}),r=Q(_=>{var T;(T=e.onFocus)==null||T.call(e,_)},_=>{const T=!o(a),{target:P,currentTarget:O}=_;if(P===O&&T&&!o(d)){const E=new Event(Ke,Lt);if(O?.dispatchEvent(E),!E.defaultPrevented){const z=p().filter(I=>I.focusable),W=z.find(I=>I.active),G=z.find(I=>I.id===o(n)),B=[W,G,...z].filter(Boolean).map(I=>I.ref);Ae(B)}}a.value=!1}),s=Q(_=>{var T;(T=e.onBlur)==null||T.call(e,_)},()=>{d.value=!1}),k=(..._)=>{l("entryFocus",..._)},M=_=>{const T=Ft(_);if(T){_.preventDefault();let O=p().filter(E=>E.focusable).map(E=>E.ref);switch(T){case"last":{O.reverse();break}case"prev":case"next":{T==="prev"&&O.reverse();const E=O.indexOf(_.currentTarget);O=e.loop?Ot(O,E+1):O.slice(E+1);break}}ge(()=>{Ae(O)})}};te(Oe,{currentTabbedId:Ho(n),loop:ee(e,"loop"),tabIndex:D(()=>o(d)?-1:0),rovingFocusGroupRef:f,rovingFocusGroupRootStyle:v,orientation:ee(e,"orientation"),dir:ee(e,"dir"),onItemFocus:m,onItemShiftTab:g,onBlur:s,onFocus:r,onMousedown:c,onKeydown:M}),ae(()=>e.currentTabId,_=>{n.value=_??null}),me(f,Ke,k)}});function Pt(e,l,t,n,d,a){return J(e.$slots,"default")}var Nt=X(Mt,[["render",Pt],["__file","roving-focus-group-impl.vue"]]);const Dt=H({name:"ElRovingFocusGroup",components:{ElFocusGroupCollection:Et,ElRovingFocusGroupImpl:Nt}});function zt(e,l,t,n,d,a){const f=K("el-roving-focus-group-impl"),p=K("el-focus-group-collection");return b(),U(p,null,{default:R(()=>[F(f,Ko(Go(e.$attrs)),{default:R(()=>[J(e.$slots,"default")]),_:3},16)]),_:3})}var Bt=X(Dt,[["render",zt],["__file","roving-focus-group.vue"]]);const ye=Symbol("elDropdown"),to="elDropdown",{ButtonGroup:At}=je,Ht=H({name:"ElDropdown",components:{ElButton:je,ElButtonGroup:At,ElScrollbar:gt,ElTooltip:ho,ElRovingFocusGroup:Bt,ElOnlyChild:go,ElIcon:Re,ArrowDown:Vo},props:mo,emits:["visible-change","click","command"],setup(e,{emit:l}){const t=Xe(),n=fe("dropdown"),{t:d}=Wo(),a=y(),f=y(),p=y(),v=y(),m=y(null),g=y(null),c=y(!1),r=D(()=>({maxHeight:Te(e.maxHeight)})),s=D(()=>[n.m(E.value)]),k=D(()=>jo(e.trigger)),M=Je().value,_=D(()=>e.id||M);function T(){var S;(S=p.value)==null||S.onClose(void 0,0)}function P(){var S;(S=p.value)==null||S.onClose()}function O(){var S;(S=p.value)==null||S.onOpen()}const E=Yo();function z(...S){l("command",...S)}function W(){}function G(){const S=o(v);k.value.includes("hover")&&S?.focus({preventScroll:!0}),g.value=null}function C(S){g.value=S}function B(){l("visible-change",!0)}function I(S){var Z;c.value=S?.type==="keydown",(Z=v.value)==null||Z.focus()}function u(){l("visible-change",!1)}return te(ye,{contentRef:v,role:D(()=>e.role),triggerId:_,isUsingKeyboard:c,onItemEnter:W,onItemLeave:G,handleClose:P}),te(to,{instance:t,dropdownSize:E,handleClick:T,commandHandler:z,trigger:ee(e,"trigger"),hideOnClick:ee(e,"hideOnClick")}),{t:d,ns:n,scrollbar:m,wrapStyle:r,dropdownTriggerKls:s,dropdownSize:E,triggerId:_,currentTabId:g,handleCurrentTabIdChange:C,handlerMainButtonClick:S=>{l("click",S)},handleClose:P,handleOpen:O,handleBeforeShowTooltip:B,handleShowTooltip:I,handleBeforeHideTooltip:u,popperRef:p,contentRef:v,triggeringElementRef:a,referenceElementRef:f}}});function Kt(e,l,t,n,d,a){var f;const p=K("el-roving-focus-group"),v=K("el-scrollbar"),m=K("el-only-child"),g=K("el-tooltip"),c=K("el-button"),r=K("arrow-down"),s=K("el-icon"),k=K("el-button-group");return b(),L("div",{class:j([e.ns.b(),e.ns.is("disabled",e.disabled)])},[F(g,{ref:"popperRef",role:e.role,effect:e.effect,"fallback-placements":["bottom","top"],"popper-options":e.popperOptions,"gpu-acceleration":!1,placement:e.placement,"popper-class":[e.ns.e("popper"),e.popperClass],"popper-style":e.popperStyle,trigger:e.trigger,"trigger-keys":e.triggerKeys,"trigger-target-el":e.contentRef,"show-arrow":e.showArrow,"show-after":e.trigger==="hover"?e.showTimeout:0,"hide-after":e.trigger==="hover"?e.hideTimeout:0,"virtual-ref":(f=e.virtualRef)!=null?f:e.triggeringElementRef,"virtual-triggering":e.virtualTriggering||e.splitButton,disabled:e.disabled,transition:`${e.ns.namespace.value}-zoom-in-top`,teleported:e.teleported,pure:"","focus-on-target":"",persistent:e.persistent,onBeforeShow:e.handleBeforeShowTooltip,onShow:e.handleShowTooltip,onBeforeHide:e.handleBeforeHideTooltip},Uo({content:R(()=>[F(v,{ref:"scrollbar","wrap-style":e.wrapStyle,tag:"div","view-class":e.ns.e("list")},{default:R(()=>[F(p,{loop:e.loop,"current-tab-id":e.currentTabId,orientation:"horizontal",onCurrentTabIdChange:e.handleCurrentTabIdChange},{default:R(()=>[J(e.$slots,"dropdown")]),_:3},8,["loop","current-tab-id","onCurrentTabIdChange"])]),_:3},8,["wrap-style","view-class"])]),_:2},[e.splitButton?void 0:{name:"default",fn:R(()=>[F(m,{id:e.triggerId,ref:"triggeringElementRef",role:"button",tabindex:e.tabindex},{default:R(()=>[J(e.$slots,"default")]),_:3},8,["id","tabindex"])])}]),1032,["role","effect","popper-options","placement","popper-class","popper-style","trigger","trigger-keys","trigger-target-el","show-arrow","show-after","hide-after","virtual-ref","virtual-triggering","disabled","transition","teleported","persistent","onBeforeShow","onShow","onBeforeHide"]),e.splitButton?(b(),U(k,{key:0},{default:R(()=>[F(c,he({ref:"referenceElementRef"},e.buttonProps,{size:e.dropdownSize,type:e.type,disabled:e.disabled,tabindex:e.tabindex,onClick:e.handlerMainButtonClick}),{default:R(()=>[J(e.$slots,"default")]),_:3},16,["size","type","disabled","tabindex","onClick"]),F(c,he({id:e.triggerId,ref:"triggeringElementRef"},e.buttonProps,{role:"button",size:e.dropdownSize,type:e.type,class:e.ns.e("caret-button"),disabled:e.disabled,tabindex:e.tabindex,"aria-label":e.t("el.dropdown.toggleDropdown")}),{default:R(()=>[F(s,{class:j(e.ns.e("icon"))},{default:R(()=>[F(r)]),_:1},8,["class"])]),_:1},16,["id","size","type","class","disabled","tabindex","aria-label"])]),_:3})):x("v-if",!0)],2)}var Gt=X(Ht,[["render",Kt],["__file","dropdown.vue"]]);const Ut=H({components:{ElRovingFocusCollectionItem:It},props:{focusable:{type:Boolean,default:!0},active:Boolean},emits:["mousedown","focus","keydown"],setup(e,{emit:l}){const{currentTabbedId:t,onItemFocus:n,onItemShiftTab:d,onKeydown:a}=V(Oe,void 0),f=Je(),p=y(),v=Q(r=>{l("mousedown",r)},r=>{e.focusable?n(o(f)):r.preventDefault()}),m=Q(r=>{l("focus",r)},()=>{n(o(f))}),g=Q(r=>{l("keydown",r)},r=>{const{shiftKey:s,target:k,currentTarget:M}=r;if(we(r)===ue.tab&&s){d();return}k===M&&a(r)}),c=D(()=>t.value===o(f));return te(oo,{rovingFocusGroupItemRef:p,tabIndex:D(()=>o(c)?0:-1),handleMousedown:v,handleFocus:m,handleKeydown:g}),{id:f,handleKeydown:g,handleFocus:m,handleMousedown:v}}});function Vt(e,l,t,n,d,a){const f=K("el-roving-focus-collection-item");return b(),U(f,{id:e.id,focusable:e.focusable,active:e.active},{default:R(()=>[J(e.$slots,"default")]),_:3},8,["id","focusable","active"])}var Wt=X(Ut,[["render",Vt],["__file","roving-focus-item.vue"]]);const Yt=H({name:"DropdownItemImpl",components:{ElIcon:Re},props:Ue,emits:["pointermove","pointerleave","click","clickimpl"],setup(e,{emit:l}){const t=fe("dropdown"),{role:n}=V(ye,void 0),{collectionItemRef:d}=V(Tt,void 0),{rovingFocusGroupItemRef:a,tabIndex:f,handleFocus:p,handleKeydown:v,handleMousedown:m}=V(oo,void 0),g=qe(d,a),c=D(()=>n.value==="menu"?"menuitem":n.value==="navigation"?"link":"button"),r=Q(s=>{const k=we(s);if([ue.enter,ue.numpadEnter,ue.space].includes(k))return s.preventDefault(),s.stopImmediatePropagation(),l("clickimpl",s),!0},v);return{ns:t,itemRef:g,dataset:{[xe]:""},role:c,tabIndex:f,handleFocus:p,handleKeydown:r,handleMousedown:m}}});function jt(e,l,t,n,d,a){const f=K("el-icon");return b(),L(re,null,[e.divided?(b(),L("li",{key:0,role:"separator",class:j(e.ns.bem("menu","item","divided"))},null,2)):x("v-if",!0),h("li",he({ref:e.itemRef},{...e.dataset,...e.$attrs},{"aria-disabled":e.disabled,class:[e.ns.be("menu","item"),e.ns.is("disabled",e.disabled)],tabindex:e.tabIndex,role:e.role,onClick:p=>e.$emit("clickimpl",p),onFocus:e.handleFocus,onKeydown:de(e.handleKeydown,["self"]),onMousedown:e.handleMousedown,onPointermove:p=>e.$emit("pointermove",p),onPointerleave:p=>e.$emit("pointerleave",p)}),[e.icon?(b(),U(f,{key:0},{default:R(()=>[(b(),U(We(e.icon)))]),_:1})):x("v-if",!0),J(e.$slots,"default")],16,["aria-disabled","tabindex","role","onClick","onFocus","onKeydown","onMousedown","onPointermove","onPointerleave"])],64)}var Jt=X(Yt,[["render",jt],["__file","dropdown-item-impl.vue"]]);const no=()=>{const e=V(to,{}),l=D(()=>e?.dropdownSize);return{elDropdown:e,_elDropdownSize:l}},Xt=H({name:"ElDropdownItem",components:{ElRovingFocusItem:Wt,ElDropdownItemImpl:Jt},inheritAttrs:!1,props:Ue,emits:["pointermove","pointerleave","click"],setup(e,{emit:l,attrs:t}){const{elDropdown:n}=no(),d=Xe(),{onItemEnter:a,onItemLeave:f}=V(ye,void 0),p=Q(c=>(l("pointermove",c),c.defaultPrevented),ze(c=>{if(e.disabled){f(c);return}const r=c.currentTarget;r===document.activeElement||r.contains(document.activeElement)||(a(c),c.defaultPrevented||r?.focus({preventScroll:!0}))})),v=Q(c=>(l("pointerleave",c),c.defaultPrevented),ze(f)),m=Q(c=>{if(!e.disabled)return l("click",c),c.type!=="keydown"&&c.defaultPrevented},c=>{var r,s,k;if(e.disabled){c.stopImmediatePropagation();return}(r=n?.hideOnClick)!=null&&r.value&&((s=n.handleClick)==null||s.call(n)),(k=n.commandHandler)==null||k.call(n,e.command,d,c)}),g=D(()=>({...e,...t}));return{handleClick:m,handlePointerMove:p,handlePointerLeave:v,propsAndAttrs:g}}});function qt(e,l,t,n,d,a){const f=K("el-dropdown-item-impl"),p=K("el-roving-focus-item");return b(),U(p,{focusable:!e.disabled},{default:R(()=>[F(f,he(e.propsAndAttrs,{onPointerleave:e.handlePointerLeave,onPointermove:e.handlePointerMove,onClickimpl:e.handleClick}),{default:R(()=>[J(e.$slots,"default")]),_:3},16,["onPointerleave","onPointermove","onClickimpl"])]),_:3},8,["focusable"])}var so=X(Xt,[["render",qt],["__file","dropdown-item.vue"]]);const Qt=H({name:"ElDropdownMenu",props:bo,setup(e){const l=fe("dropdown"),{_elDropdownSize:t}=no(),n=t.value,{contentRef:d,role:a,triggerId:f,isUsingKeyboard:p,handleClose:v}=V(ye,void 0),{rovingFocusGroupRef:m,rovingFocusGroupRootStyle:g,onBlur:c,onFocus:r,onKeydown:s,onMousedown:k}=V(Oe,void 0),{collectionRef:M}=V(eo,void 0),_=D(()=>[l.b("menu"),l.bm("menu",n?.value)]),T=qe(d,m,M),P=Q(E=>{var z;(z=e.onKeydown)==null||z.call(e,E)},E=>{const{currentTarget:z,target:W}=E,G=we(E);if(z.contains(W),ue.tab===G)return v();s(E)});function O(E){p.value&&r(E)}return{size:n,rovingFocusGroupRootStyle:g,dropdownKls:_,role:a,triggerId:f,dropdownListWrapperRef:T,handleKeydown:P,onBlur:c,handleFocus:O,onMousedown:k}}});function Zt(e,l,t,n,d,a){return b(),L("ul",{ref:e.dropdownListWrapperRef,class:j(e.dropdownKls),style:oe(e.rovingFocusGroupRootStyle),tabindex:-1,role:e.role,"aria-labelledby":e.triggerId,onFocusin:e.handleFocus,onFocusout:e.onBlur,onKeydown:de(e.handleKeydown,["self"]),onMousedown:de(e.onMousedown,["self"])},[J(e.$slots,"default")],46,["role","aria-labelledby","onFocusin","onFocusout","onKeydown","onMousedown"])}var lo=X(Qt,[["render",Zt],["__file","dropdown-menu.vue"]]);const xt=Ye(Gt,{DropdownItem:so,DropdownMenu:lo}),en=Qe(so),on=Qe(lo),tn={class:"skills-grid"},nn=["onClick"],sn=["innerHTML"],ln={class:"skill-label"},an=["innerHTML"],rn={class:"skill-label"},cn={class:"more-skills-list"},un=["onClick"],dn=["innerHTML"],fn={class:"skill-label"},pn=H({__name:"SkillSelector",props:{visibleSkills:{},moreSkills:{},moreSkillItem:{}},emits:["select"],setup(e,{emit:l}){const t=l;return(n,d)=>(b(),L("div",tn,[(b(!0),L(re,null,be(e.visibleSkills,a=>(b(),L("button",{key:a.label,class:"skill-chip",onClick:f=>t("select",a),style:oe({"--skill-color":a.color||"#4e5969"})},[h("span",{class:"skill-icon",innerHTML:a.icon},null,8,sn),h("span",ln,Y(a.label),1)],12,nn))),128)),F(o(_o),{placement:"top-start",width:200,trigger:"hover","popper-class":"more-skills-popover"},{reference:R(()=>[h("button",{class:"skill-chip",style:oe({"--skill-color":e.moreSkillItem.color})},[h("span",{class:"skill-icon",innerHTML:e.moreSkillItem.icon},null,8,an),h("span",rn,Y(e.moreSkillItem.label),1)],4)]),default:R(()=>[h("div",cn,[(b(!0),L(re,null,be(e.moreSkills,a=>(b(),L("div",{key:a.label,class:"more-skill-item",onClick:f=>t("select",a)},[h("span",{class:"skill-icon",innerHTML:a.icon,style:oe({color:a.color})},null,12,dn),h("span",fn,Y(a.label),1)],8,un))),128))])]),_:1})]))}}),Ge=Ze(pn,[["__scopeId","data-v-31e6ba22"]]),vn={class:"pc-container"},mn={class:"user-profile"},gn={key:0,class:"avatar"},hn=["src"],bn={key:1,class:"avatar"},_n={class:"action-btn"},wn={class:"recent-chats"},yn=["onClick"],Sn={class:"chat-title"},kn=["onClick"],Cn={class:"sidebar-footer"},En={class:"footer-item"},In={class:"main-content"},Tn={class:"top-bar"},$n={class:"right-actions"},Rn={key:0,class:"user-actions"},Fn={class:"welcome-text"},On={class:"content-body"},Ln={key:0,class:"chat-layout"},Mn={class:"chat-footer"},Pn={class:"footer-input-wrapper"},Nn={key:1,class:"welcome-area"},Dn={class:"welcome-card"},zn={class:"greeting"},Bn={class:"input-area-wrapper"},An=H({__name:"Home",setup(e){Qo();const l=Jo(),t=ot(),n=Xo(),d=y(!1),a=y(!1),{isListening:f,result:p,toggleListening:v}=wo(),{uploadedFiles:m,showViewer:g,previewUrlList:c,initialIndex:r,handleFileSelect:s,removeFile:k,handlePreview:M,closeViewer:_,clearFiles:T}=Eo(),{activeSkill:P,visibleSkills:O,moreSkills:E,moreSkillItem:z,handleSkillClick:W,removeSkill:G}=Io(),C=y(""),B=y(null),I=y(!1),u=y(!1);ae(()=>t.messages,()=>{B.value?.scrollToBottom()},{deep:!0});const $=async()=>{const w=C.value.trim();if(!w&&m.value.length===0||t.isSending)return;const i=[...m.value],A=P.value;C.value="",T(),P.value=null,await t.sendMessage(w,i,A,()=>{setTimeout(()=>{Se()},1e3)})},S=()=>{t.stopGenerating()},Z=()=>{if(t.isSending)return;const w=t.messages;let i="";for(let A=w.length-1;A>=0;A--){const q=w[A];if(q&&q.role==="user"){i=q.content;break}}if(i){C.value=i;const A=/^(\[æ–‡ä»¶: .*?\]\s*)+/;i.match(A)?(C.value=i.replace(A,"").trim(),ne.warning("é‡æ–°ç”Ÿæˆä»…åŒ…å«æ–‡æœ¬å†…å®¹ï¼Œæ–‡ä»¶éœ€é‡æ–°ä¸Šä¼ ")):C.value=i,$()}},Le=()=>{I.value=!I.value};ae(p,w=>{w&&(C.value=w)});const Se=async()=>{const w=n.username;if(!(!w||w==="æœªç™»å½•"))try{const i=await To(w);i&&i.data&&(t.difyConversations=i.data)}catch(i){console.error("åŠ è½½åŽ†å²ä¼šè¯å¤±è´¥",i)}};ae(()=>n.isLoggedIn,w=>{w?Se():t.clearAllConversations()}),$e(async()=>{await n.init(),n.isLoggedIn&&Se()});const Me=w=>{if(w.label==="ä¼šè®®è®°å½•"){a.value=!0;return}W(w,()=>{d.value=!0}),w.label!=="ç›¸ä¼¼åº¦è¯†åˆ«"&&ge(()=>{const i=document.querySelector(".input-box input");i&&i.focus()})},io=()=>{t.createSession(),t.setDifySessionId(null)},ao=async w=>{u.value=!0,t.clearSession(),t.setDifySessionId(w);try{const i=n.username||"guest",A=await Ro(w,i,50,"guanwang");let q=[];const ke=t.difyConversations.find(Ce=>Ce.id===w);Array.isArray(A)?q=A:A&&A.data&&(q=A.data),t.replaceMessagesFromDify(q,ke?.name||"ä¼šè¯",w)}catch(i){console.error("åŠ è½½åŽ†å²æ¶ˆæ¯å¤±è´¥",i),ne.error("åŠ è½½åŽ†å²æ¶ˆæ¯å¤±è´¥")}finally{u.value=!1}},ro=()=>{l.openLoginModal()},co=()=>{n.logout()},uo=async w=>{try{const{value:i}=await Ne.prompt("è¯·è¾“å…¥æ–°åç§°","é‡å‘½åä¼šè¯",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",inputValue:w.name,inputPattern:/\S/,inputErrorMessage:"åç§°ä¸èƒ½ä¸ºç©º"});i&&i!==w.name&&(await Fo(w.id,i,"guanwang",!1),t.renameDifyConversation(w.id,i),ne.success("é‡å‘½åæˆåŠŸ"))}catch(i){if(i==="cancel"||i==="close")return;ne.error("é‡å‘½åå¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•")}},fo=async w=>{try{await Ne.confirm("ç¡®å®šè¦åˆ é™¤è¯¥ä¼šè¯å—ï¼Ÿåˆ é™¤åŽæ— æ³•æ¢å¤ã€‚","åˆ é™¤ç¡®è®¤",{confirmButtonText:"åˆ é™¤",cancelButtonText:"å–æ¶ˆ",type:"warning"}),await Oo(w.id,"guanwang"),t.removeDifyConversation(w.id),ne.success("åˆ é™¤æˆåŠŸ")}catch(i){if(i==="cancel"||i==="close")return;ne.error("åˆ é™¤å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•")}},po=(w,i)=>{w==="rename"?uo(i):fo(i)};return(w,i)=>{const A=Re,q=en,ke=on,Ce=xt,vo=$o;return b(),L("div",vn,[h("aside",{class:j(["sidebar",{collapsed:!o(l).isSidebarOpen}])},[h("div",mn,[o(n).avatar?(b(),L("div",gn,[h("img",{src:o(n).avatar,alt:"Avatar"},null,8,hn)])):(b(),L("div",bn,"ðŸ‘©â€ðŸ’»")),le(h("span",{class:"username"},Y(o(n).isLoggedIn?o(n).username:"é©¼äººGPT"),513),[[ie,o(l).isSidebarOpen]]),le(h("button",{class:"sidebar-toggle",onClick:i[0]||(i[0]=(...N)=>o(l).toggleSidebar&&o(l).toggleSidebar(...N))},[...i[7]||(i[7]=[h("span",null,"||",-1)])],512),[[ie,o(l).isSidebarOpen]])]),le(h("div",_n,[h("button",{class:"new-chat-btn",onClick:io},[...i[8]||(i[8]=[h("span",{class:"icon"},"ðŸ“",-1),Ie(" æ–°å¯¹è¯ ",-1)])])],512),[[ie,o(l).isSidebarOpen]]),le(h("div",wn,[i[11]||(i[11]=h("div",{class:"section-title"},"æœ€è¿‘å¯¹è¯",-1)),o(t).difyConversations.length>0?(b(!0),L(re,{key:0},be(o(t).difyConversations,N=>(b(),L("div",{key:N.id,class:j(["chat-item",{active:N.id===o(t).difySessionId}]),onClick:Ee=>ao(N.id)},[h("span",Sn,Y(N.name||"æœªå‘½åå¯¹è¯"),1),F(Ce,{trigger:"click",onCommand:Ee=>po(Ee,N),class:"chat-actions"},{dropdown:R(()=>[F(ke,null,{default:R(()=>[F(q,{command:"rename",icon:o(xo)},{default:R(()=>[...i[9]||(i[9]=[Ie("é‡å‘½å",-1)])]),_:1},8,["icon"]),F(q,{command:"delete",icon:o(et),style:{color:"var(--el-color-danger)"}},{default:R(()=>[...i[10]||(i[10]=[Ie("åˆ é™¤",-1)])]),_:1},8,["icon"])]),_:1})]),default:R(()=>[h("span",{class:"el-dropdown-link",onClick:i[1]||(i[1]=de(()=>{},["stop"]))},[F(A,null,{default:R(()=>[F(o(Zo))]),_:1})])]),_:1},8,["onCommand"])],10,yn))),128)):(b(!0),L(re,{key:1},be(o(t).sessions,N=>(b(),L("div",{key:N.id,class:j(["chat-item",{active:N.id===o(t).currentSessionId}]),onClick:Ee=>o(t).switchSession(N.id)},Y(N.title),11,kn))),128))],512),[[ie,o(l).isSidebarOpen]]),le(h("div",Cn,[h("div",En,Y(o(pe).sidebarFooter),1)],512),[[ie,o(l).isSidebarOpen]])],2),h("main",In,[h("header",Tn,[o(l).isSidebarOpen?x("",!0):(b(),L("button",{key:0,class:"sidebar-toggle-main",onClick:i[2]||(i[2]=(...N)=>o(l).toggleSidebar&&o(l).toggleSidebar(...N))}," â˜° ")),h("div",$n,[o(n).isLoggedIn?(b(),L("div",Rn,[h("span",Fn,Y(o(pe).topBar.welcomePrefix)+Y(o(n).username),1),h("button",{class:"logout-btn",onClick:co},Y(o(pe).topBar.logout),1)])):(b(),L("button",{key:1,class:"login-btn",onClick:ro},Y(o(pe).topBar.login),1))])]),h("div",On,[o(t).messages.length>0||u.value?(b(),L("div",Ln,[F(o(yo),{messages:o(t).messages,ref_key:"messageListRef",ref:B,onRegenerate:Z},null,8,["messages"]),h("div",Mn,[h("div",Pn,[F(o(Pe),{modelValue:C.value,"onUpdate:modelValue":i[3]||(i[3]=N=>C.value=N),"is-sending":o(t).isSending,"is-deep-thinking":I.value,"active-skill":o(P),"uploaded-files":o(m),"is-listening":o(f),onSend:$,onStop:S,onToggleDeepThink:Le,onToggleListening:o(v),onRemoveSkill:o(G),onFileSelect:o(s),onRemoveFile:o(k),onPreviewFile:o(M)},null,8,["modelValue","is-sending","is-deep-thinking","active-skill","uploaded-files","is-listening","onToggleListening","onRemoveSkill","onFileSelect","onRemoveFile","onPreviewFile"]),F(o(Ge),{"visible-skills":o(O),"more-skills":o(E),"more-skill-item":o(z),onSelect:Me},null,8,["visible-skills","more-skills","more-skill-item"])])])])):(b(),L("div",Nn,[h("div",Dn,[h("h1",zn,Y(o(So).welcomeTitle),1),h("div",Bn,[F(o(Pe),{modelValue:C.value,"onUpdate:modelValue":i[4]||(i[4]=N=>C.value=N),"is-sending":o(t).isSending,"is-deep-thinking":I.value,"active-skill":o(P),"uploaded-files":o(m),"is-listening":o(f),onSend:$,onStop:S,onToggleDeepThink:Le,onToggleListening:o(v),onRemoveSkill:o(G),onFileSelect:o(s),onRemoveFile:o(k),onPreviewFile:o(M)},null,8,["modelValue","is-sending","is-deep-thinking","active-skill","uploaded-files","is-listening","onToggleListening","onRemoveSkill","onFileSelect","onRemoveFile","onPreviewFile"]),F(o(Ge),{"visible-skills":o(O),"more-skills":o(E),"more-skill-item":o(z),onSelect:Me},null,8,["visible-skills","more-skills","more-skill-item"])])])]))]),d.value?(b(),U(ko,{key:0,visible:d.value,"onUpdate:visible":i[5]||(i[5]=N=>d.value=N)},null,8,["visible"])):x("",!0)]),a.value?(b(),U(vo,{key:0,onClose:i[6]||(i[6]=N=>a.value=!1)})):x("",!0),(b(),U(qo,{to:"body"},[o(g)?(b(),U(o(Co),{key:0,"url-list":o(c),"initial-index":o(r),onClose:o(_)},null,8,["url-list","initial-index","onClose"])):x("",!0)]))])}}}),Un=Ze(An,[["__scopeId","data-v-e4846bf1"]]);export{Un as default};
