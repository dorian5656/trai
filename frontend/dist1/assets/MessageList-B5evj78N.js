import{o as pe,K as Le,r as E,l as J,d as oe,w as z,u as c,n as ve,i as ht,I as pt,f as k,p as _e,a5 as gt,X as mt,a6 as wt,c as D,a7 as Be,a8 as kt,q as R,D as S,R as qe,m as d,A as Ne,k as I,y as Ge,j as N,h as x,F as Me,G as yt,z as Z,v as Ct,s as xt,a9 as bt,a3 as _t,Z as Je,C as Oe}from"./index-DHyTAOuM.js";import{ax as Et,ah as he,ag as Tt,k as Ee,R as Se,O as X,_ as Fe,n as Lt,b as Qe,e as Te,w as et,h as tt,ay as Mt,az as St,aA as Ft,aB as It,i as je,m as Ht,aC as $t,aD as Rt,$ as Bt,L as Nt,g as G,E as K,a7 as Ot,aE as jt,aF as Pt,aG as Vt,a9 as Dt,aH as At,aI as zt,aJ as Ut,aK as Wt,ad as Kt,y as A,z as nt}from"./_plugin-vue_export-helper-EmPXxEAW.js";import{f as Yt,t as Xt,u as Zt}from"./user-BmGHm-Zi.js";import{M as qt,H as Pe,s as Gt}from"./github-dark-DAdqnfbh.js";var Jt=/\s/;function Qt(e){for(var n=e.length;n--&&Jt.test(e.charAt(n)););return n}var en=/^\s+/;function tn(e){return e&&e.slice(0,Qt(e)+1).replace(en,"")}var Ve=NaN,nn=/^[-+]0x[0-9a-f]+$/i,on=/^0b[01]+$/i,sn=/^0o[0-7]+$/i,rn=parseInt;function De(e){if(typeof e=="number")return e;if(Et(e))return Ve;if(he(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=he(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=tn(e);var t=on.test(e);return t||sn.test(e)?rn(e.slice(2),t?2:8):nn.test(e)?Ve:+e}var Ce=function(){return Tt.Date.now()},ln="Expected a function",an=Math.max,cn=Math.min;function un(e,n,t){var o,s,u,h,a,r,p=0,f=!1,g=!1,v=!0;if(typeof e!="function")throw new TypeError(ln);n=De(n)||0,he(t)&&(f=!!t.leading,g="maxWait"in t,u=g?an(De(t.maxWait)||0,n):u,v="trailing"in t?!!t.trailing:v);function y(_){var F=o,H=s;return o=s=void 0,p=_,h=e.apply(H,F),h}function i(_){return p=_,a=setTimeout(w,n),f?y(_):h}function m(_){var F=_-r,H=_-p,U=n-F;return g?cn(U,u-H):U}function b(_){var F=_-r,H=_-p;return r===void 0||F>=n||F<0||g&&H>=u}function w(){var _=Ce();if(b(_))return M(_);a=setTimeout(w,m(_))}function M(_){return a=void 0,v&&o?y(_):(o=s=void 0,h)}function C(){a!==void 0&&clearTimeout(a),p=0,o=r=s=a=void 0}function Q(){return a===void 0?h:M(Ce())}function ee(){var _=Ce(),F=b(_);if(o=arguments,s=this,r=_,F){if(a===void 0)return i(r);if(g)return clearTimeout(a),a=setTimeout(w,n),y(r)}return a===void 0&&(a=setTimeout(w,n)),h}return ee.cancel=C,ee.flush=Q,ee}var dn="Expected a function";function ae(e,n,t){var o=!0,s=!0;if(typeof e!="function")throw new TypeError(dn);return he(t)&&(o="leading"in t?!!t.leading:o,s="trailing"in t?!!t.trailing:s),un(e,n,{leading:o,maxWait:n,trailing:s})}let ce;const fn=e=>{var n;if(!Ee)return 0;if(ce!==void 0)return ce;const t=document.createElement("div");t.className=`${e}-scrollbar__wrap`,t.style.visibility="hidden",t.style.width="100px",t.style.position="absolute",t.style.top="-9999px",document.body.appendChild(t);const o=t.offsetWidth;t.style.overflow="scroll";const s=document.createElement("div");s.style.width="100%",t.appendChild(s);const u=s.offsetWidth;return(n=t.parentNode)==null||n.removeChild(t),ce=o-u,ce},xe="focus-trap.focus-after-trapped",be="focus-trap.focus-after-released",vn="focus-trap.focusout-prevented",Ae={cancelable:!0,bubbles:!1},hn={cancelable:!0,bubbles:!1},ze="focusAfterTrapped",Ue="focusAfterReleased",pn=Symbol("elFocusTrap"),Ie=E(),ge=E(0),He=E(0);let ue=0;const ot=e=>{const n=[],t=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:o=>{const s=o.tagName==="INPUT"&&o.type==="hidden";return o.disabled||o.hidden||s?NodeFilter.FILTER_SKIP:o.tabIndex>=0||o===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)n.push(t.currentNode);return n},We=(e,n)=>{for(const t of e)if(!gn(t,n))return t},gn=(e,n)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(n&&e===n)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},mn=e=>{const n=ot(e),t=We(n,e),o=We(n.reverse(),e);return[t,o]},wn=e=>e instanceof HTMLInputElement&&"select"in e,Y=(e,n)=>{if(e){const t=document.activeElement;Yt(e,{preventScroll:!0}),He.value=window.performance.now(),e!==t&&wn(e)&&n&&e.select()}};function Ke(e,n){const t=[...e],o=e.indexOf(n);return o!==-1&&t.splice(o,1),t}const kn=()=>{let e=[];return{push:o=>{const s=e[0];s&&o!==s&&s.pause(),e=Ke(e,o),e.unshift(o)},remove:o=>{var s,u;e=Ke(e,o),(u=(s=e[0])==null?void 0:s.resume)==null||u.call(s)}}},yn=(e,n=!1)=>{const t=document.activeElement;for(const o of e)if(Y(o,n),document.activeElement!==t)return},Ye=kn(),Cn=()=>ge.value>He.value,de=()=>{Ie.value="pointer",ge.value=window.performance.now()},Xe=()=>{Ie.value="keyboard",ge.value=window.performance.now()},xn=()=>(pe(()=>{ue===0&&(document.addEventListener("mousedown",de),document.addEventListener("touchstart",de),document.addEventListener("keydown",Xe)),ue++}),Le(()=>{ue--,ue<=0&&(document.removeEventListener("mousedown",de),document.removeEventListener("touchstart",de),document.removeEventListener("keydown",Xe))}),{focusReason:Ie,lastUserFocusTimestamp:ge,lastAutomatedFocusTimestamp:He}),fe=e=>new CustomEvent(vn,{...hn,detail:e});let ne=[];const Ze=e=>{Se(e)===X.esc&&ne.forEach(t=>t(e))},bn=e=>{pe(()=>{ne.length===0&&document.addEventListener("keydown",Ze),Ee&&ne.push(e)}),Le(()=>{ne=ne.filter(n=>n!==e),ne.length===0&&Ee&&document.removeEventListener("keydown",Ze)})},_n=oe({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[ze,Ue,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:n}){const t=E();let o,s;const{focusReason:u}=xn();bn(i=>{e.trapped&&!h.paused&&n("release-requested",i)});const h={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},a=i=>{if(!e.loop&&!e.trapped||h.paused)return;const{altKey:m,ctrlKey:b,metaKey:w,currentTarget:M,shiftKey:C}=i,{loop:Q}=e,_=Se(i)===X.tab&&!m&&!b&&!w,F=document.activeElement;if(_&&F){const H=M,[U,se]=mn(H);if(U&&se){if(!C&&F===se){const j=fe({focusReason:u.value});n("focusout-prevented",j),j.defaultPrevented||(i.preventDefault(),Q&&Y(U,!0))}else if(C&&[U,H].includes(F)){const j=fe({focusReason:u.value});n("focusout-prevented",j),j.defaultPrevented||(i.preventDefault(),Q&&Y(se,!0))}}else if(F===H){const j=fe({focusReason:u.value});n("focusout-prevented",j),j.defaultPrevented||i.preventDefault()}}};pt(pn,{focusTrapRef:t,onKeydown:a}),z(()=>e.focusTrapEl,i=>{i&&(t.value=i)},{immediate:!0}),z([t],([i],[m])=>{i&&(i.addEventListener("keydown",a),i.addEventListener("focusin",f),i.addEventListener("focusout",g)),m&&(m.removeEventListener("keydown",a),m.removeEventListener("focusin",f),m.removeEventListener("focusout",g))});const r=i=>{n(ze,i)},p=i=>n(Ue,i),f=i=>{const m=c(t);if(!m)return;const b=i.target,w=i.relatedTarget,M=b&&m.contains(b);e.trapped||w&&m.contains(w)||(o=w),M&&n("focusin",i),!h.paused&&e.trapped&&(M?s=b:Y(s,!0))},g=i=>{const m=c(t);if(!(h.paused||!m))if(e.trapped){const b=i.relatedTarget;!Lt(b)&&!m.contains(b)&&setTimeout(()=>{if(!h.paused&&e.trapped){const w=fe({focusReason:u.value});n("focusout-prevented",w),w.defaultPrevented||Y(s,!0)}},0)}else{const b=i.target;b&&m.contains(b)||n("focusout",i)}};async function v(){await ve();const i=c(t);if(i){Ye.push(h);const m=i.contains(document.activeElement)?o:document.activeElement;if(o=m,!i.contains(m)){const w=new Event(xe,Ae);i.addEventListener(xe,r),i.dispatchEvent(w),w.defaultPrevented||ve(()=>{let M=e.focusStartEl;ht(M)||(Y(M),document.activeElement!==M&&(M="first")),M==="first"&&yn(ot(i),!0),(document.activeElement===m||M==="container")&&Y(i)})}}}function y(){const i=c(t);if(i){i.removeEventListener(xe,r);const m=new CustomEvent(be,{...Ae,detail:{focusReason:u.value}});i.addEventListener(be,p),i.dispatchEvent(m),!m.defaultPrevented&&(u.value=="keyboard"||!Cn()||i.contains(document.activeElement))&&Y(o??document.body),i.removeEventListener(be,p),Ye.remove(h),o=null,s=null}}return pe(()=>{e.trapped&&v(),z(()=>e.trapped,i=>{i?v():y()})}),Le(()=>{e.trapped&&y(),t.value&&(t.value.removeEventListener("keydown",a),t.value.removeEventListener("focusin",f),t.value.removeEventListener("focusout",g),t.value=void 0),o=null,s=null}),{onKeydown:a}}});function En(e,n,t,o,s,u){return J(e.$slots,"default",{handleKeydown:e.onKeydown})}var Tn=Fe(_n,[["render",En],["__file","focus-trap.vue"]]);const Ln=Qe({to:{type:Te([String,Object]),required:!0},disabled:Boolean}),Mn=oe({__name:"teleport",props:Ln,setup(e){return(n,t)=>n.disabled?J(n.$slots,"default",{key:0}):(k(),_e(gt,{key:1,to:n.to},[J(n.$slots,"default")],8,["to"]))}});var Sn=Fe(Mn,[["__file","teleport.vue"]]);const Fn=et(Sn),In=(e,n={})=>{mt(e)||Xt("[useLockscreen]","You need to pass a ref param to this function");const t=n.ns||tt("popup"),o=D(()=>t.bm("parent","hidden"));let s=0,u=!1,h="0";const a=()=>{setTimeout(()=>{typeof document>"u"||u&&document&&(document.body.style.width=h,It(document.body,o.value))},200)};z(e,r=>{if(!r){a();return}u=!Mt(document.body,o.value),u&&(h=document.body.style.width,St(document.body,o.value)),s=fn(t.namespace.value);const p=document.documentElement.clientHeight<document.body.scrollHeight,f=Ft(document.body,"overflowY");s>0&&(p||f==="scroll")&&u&&(document.body.style.width=`calc(100% - ${s}px)`)}),wt(()=>a())},Hn=Qe({urlList:{type:Te(Array),default:()=>Ht([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},scale:{type:Number,default:1},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:Boolean,crossorigin:{type:Te(String)}}),$n={close:()=>!0,error:e=>e instanceof Event,switch:e=>je(e),rotate:e=>je(e)},Rn=oe({name:"ElImageViewer"}),Bn=oe({...Rn,props:Hn,emits:$n,setup(e,{expose:n,emit:t}){var o;const s=e,u={CONTAIN:{name:"contain",icon:Be(Rt)},ORIGINAL:{name:"original",icon:Be($t)}};let h;const{t:a}=Bt(),r=tt("image-viewer"),{nextZIndex:p}=Nt(),f=E(),g=E(),v=kt(),y=D(()=>{const{scale:l,minScale:L,maxScale:T}=s;return Wt(l,L,T)}),i=E(!0),m=E(!1),b=E(!1),w=E(s.initialIndex),M=xt(u.CONTAIN),C=E({scale:y.value,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),Q=E((o=s.zIndex)!=null?o:p());In(b,{ns:r});const ee=D(()=>{const{urlList:l}=s;return l.length<=1}),_=D(()=>w.value===0),F=D(()=>w.value===s.urlList.length-1),H=D(()=>s.urlList[w.value]),U=D(()=>[r.e("btn"),r.e("prev"),r.is("disabled",!s.infinite&&_.value)]),se=D(()=>[r.e("btn"),r.e("next"),r.is("disabled",!s.infinite&&F.value)]),$e=D(()=>{const{scale:l,deg:L,offsetX:T,offsetY:O,enableTransition:P}=C.value;let $=T/l,V=O/l;const te=L*Math.PI/180,q=Math.cos(te),re=Math.sin(te);$=$*q+V*re,V=V*q-T/l*re;const ye={transform:`scale(${l}) rotate(${L}deg) translate(${$}px, ${V}px)`,transition:P?"transform .3s":""};return M.value.name===u.CONTAIN.name&&(ye.maxWidth=ye.maxHeight="100%"),ye}),j=D(()=>`${w.value+1} / ${s.urlList.length}`);function ie(){it(),h?.(),b.value=!1,t("close")}function rt(){const l=ae(T=>{switch(Se(T)){case X.esc:s.closeOnPressEscape&&ie();break;case X.space:me();break;case X.left:we();break;case X.up:W("zoomIn");break;case X.right:ke();break;case X.down:W("zoomOut");break}}),L=ae(T=>{const O=T.deltaY||T.deltaX;W(O<0?"zoomIn":"zoomOut",{zoomRate:s.zoomRate,enableTransition:!1})});v.run(()=>{G(document,"keydown",l),G(f,"wheel",L)})}function it(){v.stop()}function lt(){i.value=!1}function at(l){m.value=!0,i.value=!1,t("error",l),l.target.alt=a("el.image.error")}function ct(l){if(i.value||l.button!==0||!f.value)return;C.value.enableTransition=!1;const{offsetX:L,offsetY:T}=C.value,O=l.pageX,P=l.pageY,$=ae(q=>{C.value={...C.value,offsetX:L+q.pageX-O,offsetY:T+q.pageY-P}}),V=G(document,"mousemove",$),te=G(document,"mouseup",()=>{V(),te()});l.preventDefault()}function ut(l){if(i.value||!f.value||l.touches.length!==1)return;C.value.enableTransition=!1;const{offsetX:L,offsetY:T}=C.value,{pageX:O,pageY:P}=l.touches[0],$=ae(q=>{const re=q.touches[0];C.value={...C.value,offsetX:L+re.pageX-O,offsetY:T+re.pageY-P}}),V=G(document,"touchmove",$),te=G(document,"touchend",()=>{V(),te()});l.preventDefault()}function Re(){C.value={scale:y.value,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function me(){if(i.value||m.value)return;const l=Ut(u),L=Object.values(u),T=M.value.name,P=(L.findIndex($=>$.name===T)+1)%l.length;M.value=u[l[P]],Re()}function le(l){m.value=!1;const L=s.urlList.length;w.value=(l+L)%L}function we(){_.value&&!s.infinite||le(w.value-1)}function ke(){F.value&&!s.infinite||le(w.value+1)}function W(l,L={}){if(i.value||m.value)return;const{minScale:T,maxScale:O}=s,{zoomRate:P,rotateDeg:$,enableTransition:V}={zoomRate:s.zoomRate,rotateDeg:90,enableTransition:!0,...L};switch(l){case"zoomOut":C.value.scale>T&&(C.value.scale=Number.parseFloat((C.value.scale/P).toFixed(3)));break;case"zoomIn":C.value.scale<O&&(C.value.scale=Number.parseFloat((C.value.scale*P).toFixed(3)));break;case"clockwise":C.value.deg+=$,t("rotate",C.value.deg);break;case"anticlockwise":C.value.deg-=$,t("rotate",C.value.deg);break}C.value.enableTransition=V}function dt(l){var L;((L=l.detail)==null?void 0:L.focusReason)==="pointer"&&l.preventDefault()}function ft(){s.closeOnPressEscape&&ie()}function vt(l){if(l.ctrlKey){if(l.deltaY<0)return l.preventDefault(),!1;if(l.deltaY>0)return l.preventDefault(),!1}}return z(()=>y.value,l=>{C.value.scale=l}),z(H,()=>{ve(()=>{const l=g.value;l?.complete||(i.value=!0)})}),z(w,l=>{Re(),t("switch",l)}),pe(()=>{b.value=!0,rt(),h=G("wheel",vt,{passive:!1})}),n({setActiveItem:le}),(l,L)=>(k(),_e(c(Fn),{to:"body",disabled:!l.teleported},{default:R(()=>[S(qe,{name:"viewer-fade",appear:""},{default:R(()=>[d("div",{ref_key:"wrapper",ref:f,tabindex:-1,class:I(c(r).e("wrapper")),style:Ne({zIndex:Q.value})},[S(c(Tn),{loop:"",trapped:"","focus-trap-el":f.value,"focus-start-el":"container",onFocusoutPrevented:dt,onReleaseRequested:ft},{default:R(()=>[d("div",{class:I(c(r).e("mask")),onClick:Ge(T=>l.hideOnClickModal&&ie(),["self"])},null,10,["onClick"]),N(" CLOSE "),d("span",{class:I([c(r).e("btn"),c(r).e("close")]),onClick:ie},[S(c(K),null,{default:R(()=>[S(c(Ot))]),_:1})],2),N(" ARROW "),c(ee)?N("v-if",!0):(k(),x(Me,{key:0},[d("span",{class:I(c(U)),onClick:we},[S(c(K),null,{default:R(()=>[S(c(jt))]),_:1})],2),d("span",{class:I(c(se)),onClick:ke},[S(c(K),null,{default:R(()=>[S(c(Pt))]),_:1})],2)],64)),l.$slots.progress||l.showProgress?(k(),x("div",{key:1,class:I([c(r).e("btn"),c(r).e("progress")])},[J(l.$slots,"progress",{activeIndex:w.value,total:l.urlList.length},()=>[yt(Z(c(j)),1)])],2)):N("v-if",!0),N(" ACTIONS "),d("div",{class:I([c(r).e("btn"),c(r).e("actions")])},[d("div",{class:I(c(r).e("actions__inner"))},[J(l.$slots,"toolbar",{actions:W,prev:we,next:ke,reset:me,activeIndex:w.value,setActiveItem:le},()=>[S(c(K),{onClick:T=>W("zoomOut")},{default:R(()=>[S(c(Vt))]),_:1},8,["onClick"]),S(c(K),{onClick:T=>W("zoomIn")},{default:R(()=>[S(c(Dt))]),_:1},8,["onClick"]),d("i",{class:I(c(r).e("actions__divider"))},null,2),S(c(K),{onClick:me},{default:R(()=>[(k(),_e(Ct(c(M).icon)))]),_:1}),d("i",{class:I(c(r).e("actions__divider"))},null,2),S(c(K),{onClick:T=>W("anticlockwise")},{default:R(()=>[S(c(At))]),_:1},8,["onClick"]),S(c(K),{onClick:T=>W("clockwise")},{default:R(()=>[S(c(zt))]),_:1},8,["onClick"])])],2)],2),N(" CANVAS "),d("div",{class:I(c(r).e("canvas"))},[m.value&&l.$slots["viewer-error"]?J(l.$slots,"viewer-error",{key:0,activeIndex:w.value,src:c(H)}):(k(),x("img",{ref_key:"imgRef",ref:g,key:c(H),src:c(H),style:Ne(c($e)),class:I(c(r).e("img")),crossorigin:l.crossorigin,onLoad:lt,onError:at,onMousedown:ct,onTouchstart:ut},null,46,["src","crossorigin"]))],2),J(l.$slots,"default")]),_:3},8,["focus-trap-el"])],6)]),_:3})]),_:3},8,["disabled"]))}});var Nn=Fe(Bn,[["__file","image-viewer.vue"]]);const No=et(Nn),Oo=bt("app",()=>{const e=E(!0),n=E(!1);return{isSidebarOpen:e,isMobileSidebarOpen:n,toggleSidebar:()=>{e.value=!e.value},toggleMobileSidebar:()=>{n.value=!n.value},closeMobileSidebar:()=>{n.value=!1}}}),On=(e,n="common",t)=>{const o=new FormData;return o.append("file",e),o.append("module",n),Kt.post("/upload/common",o,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:s=>{if(s.total&&t){const u=Math.round(s.loaded*100/s.total);t(u)}}})},st=new qt({html:!1,linkify:!0,typographer:!0,highlight:function(e,n){if(n&&Pe.getLanguage(n))try{return'<pre class="hljs"><code>'+Pe.highlight(e,{language:n,ignoreIllegals:!0}).value+"</code></pre>"}catch{}return'<pre class="hljs"><code>'+st.utils.escapeHtml(e)+"</code></pre>"}});function jn(e){return st.render(e||"")}function jo(){const e=E(!1),n=E(""),t=E("");let o=null;const s=()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const r=window.SpeechRecognition||window.webkitSpeechRecognition;o=new r,o.continuous=!1,o.interimResults=!0,o.lang="zh-CN",o.onstart=()=>{e.value=!0,t.value=""},o.onresult=p=>{let f="",g="";for(let v=p.resultIndex;v<p.results.length;++v)p.results[v].isFinal?f+=p.results[v][0].transcript:g+=p.results[v][0].transcript;n.value=f||g},o.onerror=p=>{console.error("Speech recognition error",p.error),t.value=p.error,e.value=!1,p.error==="not-allowed"?A.error("无法访问麦克风，请检查权限设置"):A.error("语音识别出错: "+p.error)},o.onend=()=>{e.value=!1}}else A.warning("您的浏览器不支持语音识别功能")},u=()=>{if(o||s(),o)try{n.value="",o.start()}catch(r){console.error(r)}},h=()=>{o&&(o.stop(),e.value=!1)},a=()=>{e.value?h():u()};return _t(()=>{o&&o.stop()}),{isListening:e,result:n,error:t,startListening:u,stopListening:h,toggleListening:a}}function Po(){const e=E([]),n=E(!1),t=E([]),o=E(0),s=f=>{if(f===0)return"0 B";const g=1024,v=["B","KB","MB","GB","TB"],y=Math.floor(Math.log(f)/Math.log(g));return parseFloat((f/Math.pow(g,y)).toFixed(1))+" "+v[y]};return{uploadedFiles:e,showViewer:n,previewUrlList:t,initialIndex:o,handleFileSelect:async f=>{const g=f.target;if(g.files&&g.files.length>0){const v=g.files[0];if(!v)return;const y={id:Date.now().toString(),name:v.name,size:s(v.size),type:v.type,progress:0,status:"uploading"};v.type.startsWith("image/")&&(y.url=URL.createObjectURL(v)),e.value.push(y),g.value="";try{const i=await On(v,"chat",m=>{y.progress=m});y.status="done",i.url&&(y.url=i.url)}catch(i){console.error("上传失败:",i),y.status="error",A.error(`${y.name} 上传失败`)}}},removeFile:f=>{const g=e.value.findIndex(v=>v.id===f);g!==-1&&e.value.splice(g,1)},handlePreview:f=>{if(f.url&&f.type.startsWith("image/")){const g=e.value.filter(y=>y.url&&y.type.startsWith("image/")).map(y=>y.url),v=g.indexOf(f.url);v!==-1&&(t.value=g,o.value=v,n.value=!0)}},closeViewer:()=>{n.value=!1},clearFiles:()=>{e.value=[]}}}function Vo(){const e=E(null),n=[{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="3" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/><circle cx="8.5" cy="8.5" r="1.5" fill="currentColor"/><polyline points="21 15 16 10 5 21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',label:"图像生成",color:"#FF8800"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',label:"帮我写作",color:"#00B42A"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><line x1="2" y1="12" x2="22" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',label:"翻译",color:"#165DFF"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M18 20V10M12 20V4M6 20v-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',label:"数据分析",color:"#722ED1"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><line x1="21" y1="21" x2="16.65" y2="16.65" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',label:"深入研究",color:"#0FC6C2"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M19 10v2a7 7 0 0 1-14 0v-2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><line x1="12" y1="19" x2="12" y2="23" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><line x1="8" y1="23" x2="16" y2="23" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',label:"AI 播客",color:"#F5319D"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><polyline points="14 2 14 8 20 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><line x1="16" y1="13" x2="8" y2="13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><line x1="16" y1="17" x2="8" y2="17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><polyline points="10 9 9 9 8 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',label:"会议记录",color:"#F53F3F"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="18" cy="18" r="3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><circle cx="6" cy="6" r="3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M13 6h3a2 2 0 0 1 2 2v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M11 18H8a2 2 0 0 1-2-2V9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',label:"相似度识别",color:"#3491FA"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="4" y="4" width="16" height="16" rx="2" stroke="currentColor" stroke-width="2"/><path d="M9 9h6M9 13h6M9 17h4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>',label:"PPT 生成",color:"#FF7D00"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M23 7l-7 5 7 5V7z"/><rect x="1" y="5" width="15" height="14" rx="2" ry="2" stroke="currentColor" stroke-width="2"/></svg>',label:"视频生成",color:"#F53F3F"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9 18V5l12-2v13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><circle cx="6" cy="18" r="3" stroke="currentColor" stroke-width="2"/><circle cx="18" cy="16" r="3" stroke="currentColor" stroke-width="2"/></svg>',label:"音乐生成",color:"#165DFF"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',label:"解题答疑",color:"#00B42A"}],t={icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2"/><rect x="14" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2"/><rect x="14" y="14" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2"/><rect x="3" y="14" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2"/></svg>',label:"更多",color:"#4E5969"},o=n.slice(0,5),s=n.slice(5);return{allSkills:n,activeSkill:e,visibleSkills:o,moreSkills:s,moreSkillItem:t,handleSkillClick:(a,r)=>{a.label==="相似度识别"?r&&r(a):e.value=a},removeSkill:()=>{e.value=null}}}function Do(e,n,t,o,s,u,h,a){const r=Zt();return{handleSend:async()=>{const g=n.value.trim();if(!g&&o.value.length===0||s.value)return;let v=g;t.value&&(v=`${t.value.label} ${g}`),o.value.length>0&&(v=`${o.value.map(w=>`[文件: ${w.name}]`).join(" ")} ${v}`),e.addMessage("user",v),n.value="",t.value=null,h(),s.value=!0,u(),e.addMessage("assistant","");const y=r.username||"guest",i=e.difySessionId;let m=null;i||(m=e.addTempDifyConversation("新对话")),await Gt({query:v,user:y,conversation_id:e.difySessionId||void 0},(b,w)=>{e.updateLastMessage(b),w&&!e.difySessionId&&(e.setDifySessionId(w),m&&e.updateTempDifyConversation(m,w),!i&&a&&a())},()=>{s.value=!1},b=>{s.value=!1,A.error("对话请求失败: "+b.message),e.updateLastMessage("❌ 请求失败，请重试。")})},handleStop:()=>{e.abortController&&(e.abortController.abort(),s.value=!1,A.info("已停止生成"))}}}const B={excel:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M14 2H6C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V8L14 2Z" fill="#217346"/>
    <path d="M14 2V8H20" fill="#E6E6E6"/>
    <path d="M16.5 17.5L14.5 14.5L16.5 11.5H14.2L13.2 13.3L12.2 11.5H10L12 14.5L10 17.5H12.3L13.3 15.7L14.3 17.5H16.5Z" fill="white"/>
  </svg>`,fileDefault:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M14 2H6C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V8L14 2Z" fill="#A0A0A0"/>
    <path d="M14 2V8H20" fill="#E6E6E6"/>
  </svg>`,closeSmall:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <line x1="18" y1="6" x2="6" y2="18"></line>
    <line x1="6" y1="6" x2="18" y2="18"></line>
  </svg>`,closeTiny:`<svg width="100%" height="100%" viewBox="0 0 12 12" fill="none">
    <path d="M2.5 2.5L9.5 9.5M9.5 2.5L2.5 9.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
  </svg>`,attachment:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M21.44 11.05L12.25 20.24C11.1242 21.3658 9.59718 21.9983 8.00504 21.9983C6.41289 21.9983 4.88588 21.3658 3.76004 20.24C2.63419 19.1142 2.00171 17.5872 2.00171 15.995C2.00171 14.4029 2.63419 12.8759 3.76004 11.75L12.95 2.56003C13.7006 1.80946 14.7186 1.38782 15.78 1.38782C16.8415 1.38782 17.8595 1.80946 18.61 2.56003C19.3606 3.31061 19.7822 4.32863 19.7822 5.39003C19.7822 6.45143 19.3606 7.46946 18.61 8.22003L9.42004 17.41C9.04475 17.7853 8.53575 17.9961 8.00504 17.9961C7.47432 17.9961 6.96532 17.7853 6.59004 17.41C6.21475 17.0347 6.00394 16.5257 6.00394 15.995C6.00394 15.4643 6.21475 14.9553 6.59004 14.58L15.07 6.10003" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>`,deepThink:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M2 12H22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M12 2C14.5013 4.73835 15.9228 8.29203 16 12C15.9228 15.708 14.5013 19.2616 12 22C9.49872 19.2616 8.07725 15.708 8 12C8.07725 8.29203 9.49872 4.73835 12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>`,micListening:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <rect x="6" y="6" width="12" height="12" fill="currentColor" rx="1"/>
  </svg>`,micNormal:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M19 10v2a7 7 0 0 1-14 0v-2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <line x1="12" y1="19" x2="12" y2="23" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <line x1="8" y1="23" x2="16" y2="23" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>`,sendSending:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <rect x="2" y="2" width="20" height="20" fill="currentColor" rx="2"/>
  </svg>`,sendNormal:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12 19V5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M5 12L12 5L19 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>`,copy:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>`,regenerate:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M23 4V10H17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M1 20V14H7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M3.51 9C4.01717 7.56678 4.87913 6.2854 6.01547 5.27542C7.1518 4.26544 8.52547 3.55977 10.0083 3.22486C11.4911 2.88994 13.0348 2.93678 14.4952 3.36094C15.9556 3.7851 17.2853 4.5727 18.36 5.65L23 10M1 14L5.64 18.35C6.71475 19.4273 8.04437 20.2149 9.50481 20.6391C10.9652 21.0632 12.5089 21.1101 13.9917 20.7751C15.4745 20.4402 16.8482 19.7346 17.9845 18.7246C19.1209 17.7146 19.9828 16.4332 20.49 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>`},Pn={class:"input-box"},Vn={key:0,class:"file-list"},Dn={class:"file-preview"},An=["src","onClick"],zn={key:1,class:"file-icon"},Un=["innerHTML"],Wn=["innerHTML"],Kn={key:2,class:"upload-mask"},Yn={key:0,class:"progress-ring"},Xn={width:"24",height:"24",viewBox:"0 0 24 24"},Zn=["stroke-dashoffset"],qn={class:"progress-text"},Gn={key:1,class:"parsing-text"},Jn={class:"file-info"},Qn=["title"],eo={class:"file-meta"},to=["onClick"],no=["innerHTML"],oo={key:0,class:"skill-tag-wrapper"},so={class:"skill-tag"},ro=["innerHTML"],io={class:"skill-tag-text"},lo=["innerHTML"],ao=["value","disabled","placeholder"],co={class:"input-actions"},uo=["innerHTML"],fo=["innerHTML"],vo=["innerHTML"],ho=["innerHTML"],po=["disabled"],go=["innerHTML"],mo=["innerHTML"],wo=oe({__name:"ChatInput",props:{modelValue:{},isSending:{type:Boolean},isDeepThinking:{type:Boolean},activeSkill:{},uploadedFiles:{},isListening:{type:Boolean}},emits:["update:modelValue","send","stop","toggleDeepThink","toggleListening","removeSkill","fileSelect","removeFile","previewFile"],setup(e,{emit:n}){const t=n,o=E(null),s=()=>{o.value?.click()},u=h=>{h.shiftKey||(h.preventDefault(),t("send"))};return(h,a)=>(k(),x("div",Pn,[d("input",{type:"file",ref_key:"fileInputRef",ref:o,style:{display:"none"},onChange:a[0]||(a[0]=r=>t("fileSelect",r))},null,544),e.uploadedFiles.length>0?(k(),x("div",Vn,[(k(!0),x(Me,null,Je(e.uploadedFiles,r=>(k(),x("div",{key:r.id,class:"file-card"},[d("div",Dn,[r.url?(k(),x("img",{key:0,src:r.url,alt:"preview",onClick:p=>t("previewFile",r),style:{cursor:"pointer"}},null,8,An)):(k(),x("div",zn,[r.name.endsWith(".xlsx")||r.name.endsWith(".xls")?(k(),x("div",{key:0,style:{width:"24px",height:"24px"},innerHTML:c(B).excel},null,8,Un)):(k(),x("div",{key:1,style:{width:"24px",height:"24px"},innerHTML:c(B).fileDefault},null,8,Wn))])),r.status!=="done"?(k(),x("div",Kn,[r.status==="uploading"?(k(),x("div",Yn,[(k(),x("svg",Xn,[a[7]||(a[7]=d("circle",{cx:"12",cy:"12",r:"10",fill:"none",stroke:"rgba(255,255,255,0.3)","stroke-width":"2"},null,-1)),d("circle",{cx:"12",cy:"12",r:"10",fill:"none",stroke:"white","stroke-width":"2","stroke-dasharray":"62.83","stroke-dashoffset":62.83*(1-r.progress/100),transform:"rotate(-90 12 12)"},null,8,Zn)])),d("span",qn,Z(r.progress)+"%",1)])):r.status==="parsing"?(k(),x("div",Gn," 解析中... ")):N("",!0)])):N("",!0)]),d("div",Jn,[d("div",{class:"file-name",title:r.name},Z(r.name),9,Qn),d("div",eo,Z(r.status==="parsing"?"解析中...":r.size),1)]),d("button",{class:"remove-file-btn",onClick:p=>t("removeFile",r.id)},[d("span",{style:{width:"12px",height:"12px",display:"block"},innerHTML:c(B).closeSmall},null,8,no)],8,to)]))),128))])):N("",!0),S(qe,{name:"fade-slide"},{default:R(()=>[e.activeSkill?(k(),x("div",oo,[d("div",so,[d("span",{class:"skill-tag-icon",innerHTML:e.activeSkill.icon},null,8,ro),d("span",io,Z(e.activeSkill.label),1),d("span",{class:"skill-tag-close",onClick:a[1]||(a[1]=Ge(r=>t("removeSkill"),["stop"]))},[d("span",{style:{width:"12px",height:"12px",display:"block"},innerHTML:c(B).closeTiny},null,8,lo)]),a[8]||(a[8]=d("div",{class:"skill-tooltip"},"点击退出技能 ESC",-1))])])):N("",!0)]),_:1}),d("input",{type:"text",value:e.modelValue,onInput:a[2]||(a[2]=r=>t("update:modelValue",r.target.value)),onKeyup:[Oe(u,["enter"]),a[3]||(a[3]=Oe(r=>t("removeSkill"),["esc"]))],disabled:e.isSending,placeholder:e.activeSkill?"请输入内容...":"发消息 or 输入“/”选择技能"},null,40,ao),d("div",co,[d("button",{class:"icon-btn",onClick:s},[d("span",{style:{width:"20px",height:"20px",display:"block"},innerHTML:c(B).attachment},null,8,uo)]),d("button",{class:I(["icon-btn deep-think-btn",{active:e.isDeepThinking}]),onClick:a[4]||(a[4]=r=>t("toggleDeepThink")),title:"深度思考"},[d("span",{style:{width:"20px",height:"20px",display:"block"},innerHTML:c(B).deepThink},null,8,fo)],2),a[9]||(a[9]=d("div",{class:"spacer"},null,-1)),d("button",{class:I(["icon-btn",{"is-listening":e.isListening}]),onClick:a[5]||(a[5]=r=>t("toggleListening")),title:"语音输入"},[e.isListening?(k(),x("span",{key:0,style:{width:"20px",height:"20px",display:"block"},innerHTML:c(B).micListening},null,8,vo)):(k(),x("span",{key:1,style:{width:"20px",height:"20px",display:"block"},innerHTML:c(B).micNormal},null,8,ho))],2),d("button",{class:"send-btn",onClick:a[6]||(a[6]=r=>e.isSending?t("stop"):t("send")),disabled:e.isSending},[e.isSending?(k(),x("span",{key:0,style:{width:"14px",height:"14px",display:"block"},innerHTML:c(B).sendSending},null,8,go)):(k(),x("span",{key:1,style:{width:"16px",height:"16px",display:"block"},innerHTML:c(B).sendNormal},null,8,mo))],8,po)])]))}}),Ao=nt(wo,[["__scopeId","data-v-e6f627cd"]]),ko={class:"chat-wrapper"},yo={class:"avatar-container"},Co={class:"avatar"},xo={class:"message-content-wrapper"},bo={class:"sender-name"},_o={class:"content-bubble"},Eo=["innerHTML"],To={key:1},Lo={key:0,class:"message-actions"},Mo=["onClick"],So=["innerHTML"],Fo=["innerHTML"],Io=oe({__name:"MessageList",props:{messages:{}},emits:["regenerate"],setup(e,{expose:n,emit:t}){const o=e,s=t,u=E(null),h=()=>{ve(()=>{u.value&&(u.value.scrollTop=u.value.scrollHeight)})},a=r=>{if(navigator.clipboard)navigator.clipboard.writeText(r).then(()=>{A.success("复制成功")}).catch(()=>{A.error("复制失败")});else{const p=document.createElement("textarea");p.value=r,document.body.appendChild(p),p.select();try{document.execCommand("copy"),A.success("复制成功")}catch{A.error("复制失败")}document.body.removeChild(p)}};return z(()=>o.messages.length,()=>{h()}),z(()=>o.messages[o.messages.length-1]?.content,()=>{h()}),n({scrollToBottom:h}),(r,p)=>(k(),x("div",ko,[d("div",{class:"message-list",ref_key:"chatContainerRef",ref:u},[(k(!0),x(Me,null,Je(e.messages,(f,g)=>(k(),x("div",{key:f.id,class:I(["message-row",f.role])},[d("div",yo,[d("div",Co,Z(f.role==="user"?"你":"AI"),1)]),d("div",xo,[d("div",bo,Z(f.role==="user"?"我":"驼人GPT"),1),d("div",_o,[f.role==="assistant"?(k(),x("div",{key:0,class:"markdown-body",innerHTML:c(jn)(f.content)},null,8,Eo)):(k(),x("div",To,Z(f.content),1))]),f.role==="assistant"&&f.content?(k(),x("div",Lo,[d("button",{class:"action-btn",title:"复制",onClick:v=>a(f.content)},[d("span",{class:"icon",innerHTML:c(B).copy},null,8,So)],8,Mo),g===e.messages.length-1?(k(),x("button",{key:0,class:"action-btn",title:"重新生成",onClick:p[0]||(p[0]=v=>s("regenerate"))},[d("span",{class:"icon",innerHTML:c(B).regenerate},null,8,Fo)])):N("",!0)])):N("",!0)])],2))),128))],512)]))}}),zo=nt(Io,[["__scopeId","data-v-302716c5"]]);export{Ao as C,Tn as E,pn as F,zo as M,Fn as a,On as b,Oo as c,jo as d,Do as e,No as f,Po as g,Vo as h,Ln as t,In as u};
