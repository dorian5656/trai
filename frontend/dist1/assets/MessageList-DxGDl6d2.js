import{bu as De,bv as oe,bw as Oe,aa as ge,z as Ae,L as ve,b7 as We,d as se,bx as pe,by as Xe,bz as Pe,b8 as Ye,F as Ke,a9 as Ze,bA as Ue,C as _,bB as Ge,X as J,ao as ye,o as Je,bC as Y,e as u,a1 as ke,a2 as F,W as b,aw as be,aF as l,I as fe,K as H,J as o,ac as qe,aP as _e,a4 as B,b0 as O,b5 as Qe,c as v,T as ue,bD as et,bE as tt,B as te,aE as nt,aB as A,bF as ot,bb as st,aX as rt,bG as it,bH as lt,ay as at,D as N,bI as ct,a7 as dt,bJ as ut,A as ht,an as gt,ag as Z,ad as vt,bi as pt,bK as kt,bj as W,bk as ft,aW as Me,b9 as we,_ as Le}from"./index-DcelCsWV.js";import{M as wt,H as me}from"./github-dark-DOSha1VK.js";var mt=/\s/;function xt(e){for(var a=e.length;a--&&mt.test(e.charAt(a)););return a}var Ct=/^\s+/;function yt(e){return e&&e.slice(0,xt(e)+1).replace(Ct,"")}var xe=NaN,bt=/^[-+]0x[0-9a-f]+$/i,_t=/^0b[01]+$/i,Mt=/^0o[0-7]+$/i,Lt=parseInt;function Ce(e){if(typeof e=="number")return e;if(De(e))return xe;if(oe(e)){var a=typeof e.valueOf=="function"?e.valueOf():e;e=oe(a)?a+"":a}if(typeof e!="string")return e===0?e:+e;e=yt(e);var s=_t.test(e);return s||Mt.test(e)?Lt(e.slice(2),s?2:8):bt.test(e)?xe:+e}var de=function(){return Oe.Date.now()},Tt="Expected a function",Ht=Math.max,It=Math.min;function St(e,a,s){var r,c,k,w,i,t,h=0,d=!1,p=!1,g=!0;if(typeof e!="function")throw new TypeError(Tt);a=Ce(a)||0,oe(s)&&(d=!!s.leading,p="maxWait"in s,k=p?Ht(Ce(s.maxWait)||0,a):k,g="trailing"in s?!!s.trailing:g);function y(m){var E=r,V=c;return r=c=void 0,h=m,w=e.apply(V,E),w}function M(m){return h=m,i=setTimeout(L,a),d?y(m):w}function T(m){var E=m-t,V=m-h,q=a-E;return p?It(q,k-V):q}function j(m){var E=m-t,V=m-h;return t===void 0||E>=a||E<0||p&&V>=k}function L(){var m=de();if(j(m))return X(m);i=setTimeout(L,T(m))}function X(m){return i=void 0,g&&r?y(m):(r=c=void 0,w)}function f(){i!==void 0&&clearTimeout(i),h=0,r=t=c=i=void 0}function re(){return i===void 0?w:X(de())}function U(){var m=de(),E=j(m);if(r=arguments,c=this,t=m,E){if(i===void 0)return M(t);if(p)return clearTimeout(i),i=setTimeout(L,a),y(t)}return i===void 0&&(i=setTimeout(L,a)),w}return U.cancel=f,U.flush=re,U}var Ft="Expected a function";function ne(e,a,s){var r=!0,c=!0;if(typeof e!="function")throw new TypeError(Ft);return oe(s)&&(r="leading"in s?!!s.leading:r,c="trailing"in s?!!s.trailing:c),St(e,a,{leading:r,maxWait:a,trailing:c})}const Bt=Ae({urlList:{type:ve(Array),default:()=>We([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},scale:{type:Number,default:1},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:Boolean,crossorigin:{type:ve(String)}}),Et={close:()=>!0,error:e=>e instanceof Event,switch:e=>ge(e),rotate:e=>ge(e)},$t=se({name:"ElImageViewer"}),jt=se({...$t,props:Bt,emits:Et,setup(e,{expose:a,emit:s}){var r;const c=e,k={CONTAIN:{name:"contain",icon:pe(Pe)},ORIGINAL:{name:"original",icon:pe(Xe)}};let w;const{t:i}=Ye(),t=Ke("image-viewer"),{nextZIndex:h}=Ze(),d=_(),p=_(),g=Ue(),y=N(()=>{const{scale:n,minScale:C,maxScale:x}=c;return ct(n,C,x)}),M=_(!0),T=_(!1),j=_(!1),L=_(c.initialIndex),X=dt(k.CONTAIN),f=_({scale:y.value,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),re=_((r=c.zIndex)!=null?r:h());Ge(j,{ns:t});const U=N(()=>{const{urlList:n}=c;return n.length<=1}),m=N(()=>L.value===0),E=N(()=>L.value===c.urlList.length-1),V=N(()=>c.urlList[L.value]),q=N(()=>[t.e("btn"),t.e("prev"),t.is("disabled",!c.infinite&&m.value)]),He=N(()=>[t.e("btn"),t.e("next"),t.is("disabled",!c.infinite&&E.value)]),Ie=N(()=>{const{scale:n,deg:C,offsetX:x,offsetY:$,enableTransition:R}=f.value;let S=x/n,z=$/n;const K=C*Math.PI/180,P=Math.cos(K),G=Math.sin(K);S=S*P+z*G,z=z*P-x/n*G;const ce={transform:`scale(${n}) rotate(${C}deg) translate(${S}px, ${z}px)`,transition:R?"transform .3s":""};return X.value.name===k.CONTAIN.name&&(ce.maxWidth=ce.maxHeight="100%"),ce}),Se=N(()=>`${L.value+1} / ${c.urlList.length}`);function Q(){Be(),w?.(),j.value=!1,s("close")}function Fe(){const n=ne(x=>{switch(gt(x)){case Z.esc:c.closeOnPressEscape&&Q();break;case Z.space:ie();break;case Z.left:le();break;case Z.up:D("zoomIn");break;case Z.right:ae();break;case Z.down:D("zoomOut");break}}),C=ne(x=>{const $=x.deltaY||x.deltaX;D($<0?"zoomIn":"zoomOut",{zoomRate:c.zoomRate,enableTransition:!1})});g.run(()=>{Y(document,"keydown",n),Y(d,"wheel",C)})}function Be(){g.stop()}function Ee(){M.value=!1}function $e(n){T.value=!0,M.value=!1,s("error",n),n.target.alt=i("el.image.error")}function je(n){if(M.value||n.button!==0||!d.value)return;f.value.enableTransition=!1;const{offsetX:C,offsetY:x}=f.value,$=n.pageX,R=n.pageY,S=ne(P=>{f.value={...f.value,offsetX:C+P.pageX-$,offsetY:x+P.pageY-R}}),z=Y(document,"mousemove",S),K=Y(document,"mouseup",()=>{z(),K()});n.preventDefault()}function Ve(n){if(M.value||!d.value||n.touches.length!==1)return;f.value.enableTransition=!1;const{offsetX:C,offsetY:x}=f.value,{pageX:$,pageY:R}=n.touches[0],S=ne(P=>{const G=P.touches[0];f.value={...f.value,offsetX:C+G.pageX-$,offsetY:x+G.pageY-R}}),z=Y(document,"touchmove",S),K=Y(document,"touchend",()=>{z(),K()});n.preventDefault()}function he(){f.value={scale:y.value,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function ie(){if(M.value||T.value)return;const n=ut(k),C=Object.values(k),x=X.value.name,R=(C.findIndex(S=>S.name===x)+1)%n.length;X.value=k[n[R]],he()}function ee(n){T.value=!1;const C=c.urlList.length;L.value=(n+C)%C}function le(){m.value&&!c.infinite||ee(L.value-1)}function ae(){E.value&&!c.infinite||ee(L.value+1)}function D(n,C={}){if(M.value||T.value)return;const{minScale:x,maxScale:$}=c,{zoomRate:R,rotateDeg:S,enableTransition:z}={zoomRate:c.zoomRate,rotateDeg:90,enableTransition:!0,...C};switch(n){case"zoomOut":f.value.scale>x&&(f.value.scale=Number.parseFloat((f.value.scale/R).toFixed(3)));break;case"zoomIn":f.value.scale<$&&(f.value.scale=Number.parseFloat((f.value.scale*R).toFixed(3)));break;case"clockwise":f.value.deg+=S,s("rotate",f.value.deg);break;case"anticlockwise":f.value.deg-=S,s("rotate",f.value.deg);break}f.value.enableTransition=z}function Re(n){var C;((C=n.detail)==null?void 0:C.focusReason)==="pointer"&&n.preventDefault()}function ze(){c.closeOnPressEscape&&Q()}function Ne(n){if(n.ctrlKey){if(n.deltaY<0)return n.preventDefault(),!1;if(n.deltaY>0)return n.preventDefault(),!1}}return J(()=>y.value,n=>{f.value.scale=n}),J(V,()=>{ye(()=>{const n=p.value;n?.complete||(M.value=!0)})}),J(L,n=>{he(),s("switch",n)}),Je(()=>{j.value=!0,Fe(),w=Y("wheel",Ne,{passive:!1})}),a({setActiveItem:ee}),(n,C)=>(u(),ke(o(at),{to:"body",disabled:!n.teleported},{default:F(()=>[b(be,{name:"viewer-fade",appear:""},{default:F(()=>[l("div",{ref_key:"wrapper",ref:d,tabindex:-1,class:H(o(t).e("wrapper")),style:fe({zIndex:re.value})},[b(o(qe),{loop:"",trapped:"","focus-trap-el":d.value,"focus-start-el":"container",onFocusoutPrevented:Re,onReleaseRequested:ze},{default:F(()=>[l("div",{class:H(o(t).e("mask")),onClick:_e(x=>n.hideOnClickModal&&Q(),["self"])},null,10,["onClick"]),B(" CLOSE "),l("span",{class:H([o(t).e("btn"),o(t).e("close")]),onClick:Q},[b(o(O),null,{default:F(()=>[b(o(Qe))]),_:1})],2),B(" ARROW "),o(U)?B("v-if",!0):(u(),v(ue,{key:0},[l("span",{class:H(o(q)),onClick:le},[b(o(O),null,{default:F(()=>[b(o(et))]),_:1})],2),l("span",{class:H(o(He)),onClick:ae},[b(o(O),null,{default:F(()=>[b(o(tt))]),_:1})],2)],64)),n.$slots.progress||n.showProgress?(u(),v("div",{key:1,class:H([o(t).e("btn"),o(t).e("progress")])},[te(n.$slots,"progress",{activeIndex:L.value,total:n.urlList.length},()=>[nt(A(o(Se)),1)])],2)):B("v-if",!0),B(" ACTIONS "),l("div",{class:H([o(t).e("btn"),o(t).e("actions")])},[l("div",{class:H(o(t).e("actions__inner"))},[te(n.$slots,"toolbar",{actions:D,prev:le,next:ae,reset:ie,activeIndex:L.value,setActiveItem:ee},()=>[b(o(O),{onClick:x=>D("zoomOut")},{default:F(()=>[b(o(ot))]),_:1},8,["onClick"]),b(o(O),{onClick:x=>D("zoomIn")},{default:F(()=>[b(o(st))]),_:1},8,["onClick"]),l("i",{class:H(o(t).e("actions__divider"))},null,2),b(o(O),{onClick:ie},{default:F(()=>[(u(),ke(rt(o(X).icon)))]),_:1}),l("i",{class:H(o(t).e("actions__divider"))},null,2),b(o(O),{onClick:x=>D("anticlockwise")},{default:F(()=>[b(o(it))]),_:1},8,["onClick"]),b(o(O),{onClick:x=>D("clockwise")},{default:F(()=>[b(o(lt))]),_:1},8,["onClick"])])],2)],2),B(" CANVAS "),l("div",{class:H(o(t).e("canvas"))},[T.value&&n.$slots["viewer-error"]?te(n.$slots,"viewer-error",{key:0,activeIndex:L.value,src:o(V)}):(u(),v("img",{ref_key:"imgRef",ref:p,key:o(V),src:o(V),style:fe(o(Ie)),class:H(o(t).e("img")),crossorigin:n.crossorigin,onLoad:Ee,onError:$e,onMousedown:je,onTouchstart:Ve},null,46,["src","crossorigin"]))],2),te(n.$slots,"default")]),_:3},8,["focus-trap-el"])],6)]),_:3})]),_:3},8,["disabled"]))}});var Vt=ht(jt,[["__file","image-viewer.vue"]]);const jn=vt(Vt),I={excel:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M14 2H6C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V8L14 2Z" fill="#217346"/>
    <path d="M14 2V8H20" fill="#E6E6E6"/>
    <path d="M16.5 17.5L14.5 14.5L16.5 11.5H14.2L13.2 13.3L12.2 11.5H10L12 14.5L10 17.5H12.3L13.3 15.7L14.3 17.5H16.5Z" fill="white"/>
  </svg>`,fileDefault:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M14 2H6C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V8L14 2Z" fill="#A0A0A0"/>
    <path d="M14 2V8H20" fill="#E6E6E6"/>
  </svg>`,audio:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M14 2H6C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V8L14 2Z" fill="#FFA000"/>
    <path d="M14 2V8H20" fill="#FFE082"/>
    <path d="M12 18V13M12 18C13.1046 18 14 17.1046 14 16C14 14.8954 13.1046 14 12 14C10.8954 14 10 14.8954 10 16C10 17.1046 10.8954 18 12 18ZM12 13V11L15 10V13" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>`,closeSmall:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <line x1="18" y1="6" x2="6" y2="18"></line>
    <line x1="6" y1="6" x2="18" y2="18"></line>
  </svg>`,closeTiny:`<svg width="100%" height="100%" viewBox="0 0 12 12" fill="none">
    <path d="M2.5 2.5L9.5 9.5M9.5 2.5L2.5 9.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
  </svg>`,attachment:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M21.44 11.05L12.25 20.24C11.1242 21.3658 9.59718 21.9983 8.00504 21.9983C6.41289 21.9983 4.88588 21.3658 3.76004 20.24C2.63419 19.1142 2.00171 17.5872 2.00171 15.995C2.00171 14.4029 2.63419 12.8759 3.76004 11.75L12.95 2.56003C13.7006 1.80946 14.7186 1.38782 15.78 1.38782C16.8415 1.38782 17.8595 1.80946 18.61 2.56003C19.3606 3.31061 19.7822 4.32863 19.7822 5.39003C19.7822 6.45143 19.3606 7.46946 18.61 8.22003L9.42004 17.41C9.04475 17.7853 8.53575 17.9961 8.00504 17.9961C7.47432 17.9961 6.96532 17.7853 6.59004 17.41C6.21475 17.0347 6.00394 16.5257 6.00394 15.995C6.00394 15.4643 6.21475 14.9553 6.59004 14.58L15.07 6.10003" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>`,deepThink:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M2 12H22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M12 2C14.5013 4.73835 15.9228 8.29203 16 12C15.9228 15.708 14.5013 19.2616 12 22C9.49872 19.2616 8.07725 15.708 8 12C8.07725 8.29203 9.49872 4.73835 12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>`,micListening:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <rect x="6" y="6" width="12" height="12" fill="currentColor" rx="1"/>
  </svg>`,micNormal:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M19 10v2a7 7 0 0 1-14 0v-2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <line x1="12" y1="19" x2="12" y2="23" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <line x1="8" y1="23" x2="16" y2="23" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>`,sendSending:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <rect x="2" y="2" width="20" height="20" fill="currentColor" rx="2"/>
  </svg>`,sendNormal:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12 19V5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M5 12L12 5L19 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>`,copy:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M5 15H4C2.89543 15 2 14.1046 2 13V4C2 2.89543 2.89543 2 4 2H13C14.1046 2 15 2.89543 15 4V5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>`,regenerate:`<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M23 4V10H17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M1 20V14H7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M3.51 9C4.01717 7.56678 4.87913 6.2854 6.01547 5.27542C7.1518 4.26544 8.52547 3.55977 10.0083 3.22486C11.4911 2.88994 13.0348 2.93678 14.4952 3.36094C15.9556 3.7851 17.2853 4.5727 18.36 5.65L23 10M1 14L5.64 18.35C6.71475 19.4273 8.04437 20.2149 9.50481 20.6391C10.9652 21.0632 12.5089 21.1101 13.9917 20.7751C15.4745 20.4402 16.8482 19.7346 17.9845 18.7246C19.1209 17.7146 19.9828 16.4332 20.49 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>`},Rt=(e,a="common",s)=>{const r=new FormData;return r.append("file",e),r.append("module",a),pt.post("/upload/common",r,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:c=>{if(c.total&&s){const k=Math.round(c.loaded*100/c.total);s(k)}}})};function Vn(){const e=_(!1),a=_(""),s=_("");let r=null;const c=()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const t=window.SpeechRecognition||window.webkitSpeechRecognition;r=new t,r.continuous=!1,r.interimResults=!0,r.lang="zh-CN",r.onstart=()=>{e.value=!0,s.value=""},r.onresult=h=>{let d="",p="";for(let g=h.resultIndex;g<h.results.length;++g)h.results[g].isFinal?d+=h.results[g][0].transcript:p+=h.results[g][0].transcript;a.value=d||p},r.onerror=h=>{console.error("Speech recognition error",h.error),s.value=h.error,e.value=!1,h.error==="not-allowed"?W.error("无法访问麦克风，请检查权限设置"):W.error("语音识别出错: "+h.error)},r.onend=()=>{e.value=!1}}else W.warning("您的浏览器不支持语音识别功能")},k=()=>{if(r||c(),r)try{a.value="",r.start()}catch(t){console.error(t)}},w=()=>{r&&(r.stop(),e.value=!1)},i=()=>{e.value?w():k()};return kt(()=>{r&&r.stop()}),{isListening:e,result:a,error:s,startListening:k,stopListening:w,toggleListening:i}}function Rn(){const e=_([]),a=_(!1),s=_([]),r=_(0),c=d=>{if(d===0)return"0 B";const p=1024,g=["B","KB","MB","GB","TB"],y=Math.floor(Math.log(d)/Math.log(p));return parseFloat((d/Math.pow(p,y)).toFixed(1))+" "+g[y]};return{uploadedFiles:e,showViewer:a,previewUrlList:s,initialIndex:r,handleFileSelect:async d=>{const p=d.target;if(p.files&&p.files.length>0){const g=p.files[0];if(!g)return;const y={id:Date.now().toString(),name:g.name,size:c(g.size),type:g.type,progress:0,status:"uploading"};g.type.startsWith("image/")&&(y.url=URL.createObjectURL(g)),e.value.push(y),p.value="";const M=e.value.find(T=>T.id===y.id);try{const T=await Rt(g,"chat",j=>{M.progress=j});M.status="done",T.url&&(M.url=T.url),M.progress=100}catch(T){console.error("上传失败:",T),M.status="error";const j=ft.handleHttpError(T);W.error(`${M.name} 上传失败: ${j.message}`)}}},removeFile:d=>{const p=e.value.findIndex(g=>g.id===d);p!==-1&&e.value.splice(p,1)},handlePreview:d=>{if(d.url&&d.type.startsWith("image/")){const p=e.value.filter(y=>y.url&&y.type.startsWith("image/")).map(y=>y.url),g=p.indexOf(d.url);g!==-1&&(s.value=p,r.value=g,a.value=!0)}},closeViewer:()=>{a.value=!1},clearFiles:()=>{e.value=[]}}}function zn(){const e=_(null),a=[{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="3" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/><circle cx="8.5" cy="8.5" r="1.5" fill="currentColor"/><polyline points="21 15 16 10 5 21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',label:"图像生成",color:"#FF8800"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><polyline points="14 2 14 8 20 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><line x1="16" y1="13" x2="8" y2="13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><line x1="16" y1="17" x2="8" y2="17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><polyline points="10 9 9 9 8 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',label:"会议记录",color:"#F53F3F"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',label:"帮我写作",color:"#00B42A"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><line x1="2" y1="12" x2="22" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',label:"翻译",color:"#165DFF"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M18 20V10M12 20V4M6 20v-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',label:"数据分析",color:"#722ED1"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><line x1="21" y1="21" x2="16.65" y2="16.65" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',label:"深入研究",color:"#0FC6C2"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M19 10v2a7 7 0 0 1-14 0v-2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><line x1="12" y1="19" x2="12" y2="23" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><line x1="8" y1="23" x2="16" y2="23" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',label:"AI 播客",color:"#F5319D"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="18" cy="18" r="3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><circle cx="6" cy="6" r="3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M13 6h3a2 2 0 0 1 2 2v7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M11 18H8a2 2 0 0 1-2-2V9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',label:"相似度识别",color:"#3491FA"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="4" y="4" width="16" height="16" rx="2" stroke="currentColor" stroke-width="2"/><path d="M9 9h6M9 13h6M9 17h4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>',label:"PPT 生成",color:"#FF7D00"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M23 7l-7 5 7 5V7z"/><rect x="1" y="5" width="15" height="14" rx="2" ry="2" stroke="currentColor" stroke-width="2"/></svg>',label:"视频生成",color:"#F53F3F"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9 18V5l12-2v13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><circle cx="6" cy="18" r="3" stroke="currentColor" stroke-width="2"/><circle cx="18" cy="16" r="3" stroke="currentColor" stroke-width="2"/></svg>',label:"音乐生成",color:"#165DFF"},{icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',label:"解题答疑",color:"#00B42A"}],s={icon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2"/><rect x="14" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2"/><rect x="14" y="14" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2"/><rect x="3" y="14" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2"/></svg>',label:"更多",color:"#4E5969"},r=a.slice(0,5),c=a.slice(5);return{allSkills:a,activeSkill:e,visibleSkills:r,moreSkills:c,moreSkillItem:s,handleSkillClick:(i,t)=>{i.label==="相似度识别"?t&&t(i):e.value=i},removeSkill:()=>{e.value=null}}}const zt={class:"input-box"},Nt={key:0,class:"file-list"},Dt={class:"file-preview"},Ot=["src","onClick"],At={key:1,class:"file-icon"},Wt=["innerHTML"],Xt=["innerHTML"],Pt=["innerHTML"],Yt={key:2,class:"upload-mask"},Kt={key:0,class:"progress-ring"},Zt={width:"24",height:"24",viewBox:"0 0 24 24"},Ut=["stroke-dashoffset"],Gt={class:"progress-text"},Jt={key:1,class:"parsing-text"},qt={class:"file-info"},Qt=["title"],en={class:"file-meta"},tn=["onClick"],nn=["innerHTML"],on={key:0,class:"skill-tag-wrapper"},sn={class:"skill-tag"},rn=["innerHTML"],ln={class:"skill-tag-text"},an=["innerHTML"],cn=["value","disabled","placeholder"],dn={class:"input-actions"},un=["innerHTML"],hn=["innerHTML"],gn=["innerHTML"],vn=["innerHTML"],pn=["disabled"],kn=["innerHTML"],fn=["innerHTML"],wn=se({__name:"ChatInput",props:{modelValue:{},isSending:{type:Boolean},isDeepThinking:{type:Boolean},activeSkill:{},uploadedFiles:{},isListening:{type:Boolean}},emits:["update:modelValue","send","stop","toggleDeepThink","toggleListening","removeSkill","fileSelect","removeFile","previewFile"],setup(e,{emit:a}){const s=a,r=_(null),c=()=>{r.value?.click()},k=w=>{w.shiftKey||(w.preventDefault(),s("send"))};return(w,i)=>(u(),v("div",zt,[l("input",{type:"file",ref_key:"fileInputRef",ref:r,style:{display:"none"},onChange:i[0]||(i[0]=t=>s("fileSelect",t))},null,544),e.uploadedFiles.length>0?(u(),v("div",Nt,[(u(!0),v(ue,null,Me(e.uploadedFiles,t=>(u(),v("div",{key:t.id,class:"file-card"},[l("div",Dt,[t.url&&t.type.startsWith("image/")?(u(),v("img",{key:0,src:t.url,alt:"preview",onClick:h=>s("previewFile",t),style:{cursor:"pointer"}},null,8,Ot)):(u(),v("div",At,[t.name.endsWith(".xlsx")||t.name.endsWith(".xls")?(u(),v("div",{key:0,style:{width:"24px",height:"24px"},innerHTML:o(I).excel},null,8,Wt)):t.name.endsWith(".mp3")||t.name.endsWith(".wav")||t.name.endsWith(".m4a")||t.type.startsWith("audio/")?(u(),v("div",{key:1,style:{width:"24px",height:"24px"},innerHTML:o(I).audio},null,8,Xt)):(u(),v("div",{key:2,style:{width:"24px",height:"24px"},innerHTML:o(I).fileDefault},null,8,Pt))])),t.status!=="done"?(u(),v("div",Yt,[t.status==="uploading"?(u(),v("div",Kt,[(u(),v("svg",Zt,[i[7]||(i[7]=l("circle",{cx:"12",cy:"12",r:"10",fill:"none",stroke:"rgba(255,255,255,0.3)","stroke-width":"2"},null,-1)),l("circle",{cx:"12",cy:"12",r:"10",fill:"none",stroke:"white","stroke-width":"2","stroke-dasharray":"62.83","stroke-dashoffset":62.83*(1-t.progress/100),transform:"rotate(-90 12 12)"},null,8,Ut)])),l("span",Gt,A(t.progress)+"%",1)])):t.status==="parsing"?(u(),v("div",Jt," 解析中... ")):B("",!0)])):B("",!0)]),l("div",qt,[l("div",{class:"file-name",title:t.name},A(t.name),9,Qt),l("div",en,A(t.status==="parsing"?"解析中...":t.size),1)]),l("button",{class:"remove-file-btn",onClick:h=>s("removeFile",t.id)},[l("span",{style:{width:"12px",height:"12px",display:"block"},innerHTML:o(I).closeSmall},null,8,nn)],8,tn)]))),128))])):B("",!0),b(be,{name:"fade-slide"},{default:F(()=>[e.activeSkill?(u(),v("div",on,[l("div",sn,[l("span",{class:"skill-tag-icon",innerHTML:e.activeSkill.icon},null,8,rn),l("span",ln,A(e.activeSkill.label),1),l("span",{class:"skill-tag-close",onClick:i[1]||(i[1]=_e(t=>s("removeSkill"),["stop"]))},[l("span",{style:{width:"12px",height:"12px",display:"block"},innerHTML:o(I).closeTiny},null,8,an)]),i[8]||(i[8]=l("div",{class:"skill-tooltip"},"点击退出技能 ESC",-1))])])):B("",!0)]),_:1}),l("input",{type:"text",value:e.modelValue,onInput:i[2]||(i[2]=t=>s("update:modelValue",t.target.value)),onKeyup:[we(k,["enter"]),i[3]||(i[3]=we(t=>s("removeSkill"),["esc"]))],disabled:e.isSending,placeholder:e.activeSkill?"请输入内容...":"发消息 or 输入“/”选择技能"},null,40,cn),l("div",dn,[l("button",{class:"icon-btn",onClick:c},[l("span",{style:{width:"20px",height:"20px",display:"block"},innerHTML:o(I).attachment},null,8,un)]),l("button",{class:H(["icon-btn deep-think-btn",{active:e.isDeepThinking}]),onClick:i[4]||(i[4]=t=>s("toggleDeepThink")),title:"深度思考"},[l("span",{style:{width:"20px",height:"20px",display:"block"},innerHTML:o(I).deepThink},null,8,hn)],2),i[9]||(i[9]=l("div",{class:"spacer"},null,-1)),l("button",{class:H(["icon-btn",{"is-listening":e.isListening}]),onClick:i[5]||(i[5]=t=>s("toggleListening")),title:"语音输入"},[e.isListening?(u(),v("span",{key:0,style:{width:"20px",height:"20px",display:"block"},innerHTML:o(I).micListening},null,8,gn)):(u(),v("span",{key:1,style:{width:"20px",height:"20px",display:"block"},innerHTML:o(I).micNormal},null,8,vn))],2),l("button",{class:"send-btn",onClick:i[6]||(i[6]=t=>e.isSending?s("stop"):s("send")),disabled:e.isSending},[e.isSending?(u(),v("span",{key:0,style:{width:"14px",height:"14px",display:"block"},innerHTML:o(I).sendSending},null,8,kn)):(u(),v("span",{key:1,style:{width:"16px",height:"16px",display:"block"},innerHTML:o(I).sendNormal},null,8,fn))],8,pn)])]))}}),Nn=Le(wn,[["__scopeId","data-v-c9f0a040"]]),Te=new wt({html:!1,linkify:!0,typographer:!0,highlight:function(e,a){if(a&&me.getLanguage(a))try{return'<pre class="hljs"><code>'+me.highlight(e,{language:a,ignoreIllegals:!0}).value+"</code></pre>"}catch{}return'<pre class="hljs"><code>'+Te.utils.escapeHtml(e)+"</code></pre>"}});function mn(e){return Te.render(e||"")}const xn={class:"chat-wrapper"},Cn={class:"avatar-container"},yn={class:"avatar"},bn={class:"message-content-wrapper"},_n={class:"sender-name"},Mn={class:"content-bubble"},Ln=["innerHTML"],Tn={key:1},Hn={key:0,class:"message-actions"},In=["onClick"],Sn=["innerHTML"],Fn=["innerHTML"],Bn=se({__name:"MessageList",props:{messages:{}},emits:["regenerate"],setup(e,{expose:a,emit:s}){const r=e,c=s,k=_(null),w=()=>{ye(()=>{k.value&&(k.value.scrollTop=k.value.scrollHeight)})},i=t=>{if(navigator.clipboard)navigator.clipboard.writeText(t).then(()=>{W.success("复制成功")}).catch(()=>{W.error("复制失败")});else{const h=document.createElement("textarea");h.value=t,document.body.appendChild(h),h.select();try{document.execCommand("copy"),W.success("复制成功")}catch{W.error("复制失败")}document.body.removeChild(h)}};return J(()=>r.messages.length,()=>{w()}),J(()=>r.messages[r.messages.length-1]?.content,()=>{w()}),a({scrollToBottom:w}),(t,h)=>(u(),v("div",xn,[l("div",{class:"message-list",ref_key:"chatContainerRef",ref:k},[(u(!0),v(ue,null,Me(e.messages,(d,p)=>(u(),v("div",{key:d.id,class:H(["message-row",d.role])},[l("div",Cn,[l("div",yn,A(d.role==="user"?"你":"AI"),1)]),l("div",bn,[l("div",_n,A(d.role==="user"?"我":"驼人GPT"),1),l("div",Mn,[d.role==="assistant"?(u(),v("div",{key:0,class:"markdown-body",innerHTML:o(mn)(d.content)},null,8,Ln)):(u(),v("div",Tn,A(d.content),1))]),d.role==="assistant"&&d.content?(u(),v("div",Hn,[l("button",{class:"action-btn",title:"复制",onClick:g=>i(d.content)},[l("span",{class:"icon",innerHTML:o(I).copy},null,8,Sn)],8,In),p===e.messages.length-1?(u(),v("button",{key:0,class:"action-btn",title:"重新生成",onClick:h[0]||(h[0]=g=>c("regenerate"))},[l("span",{class:"icon",innerHTML:o(I).regenerate},null,8,Fn)])):B("",!0)])):B("",!0)])],2))),128))],512)]))}}),Dn=Le(Bn,[["__scopeId","data-v-0d4e68ae"]]);export{Nn as C,jn as E,Dn as M,Vn as a,Rn as b,zn as c,I as i,Rt as u};
