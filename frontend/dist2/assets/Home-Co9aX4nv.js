import{d as te,u as ae,a3 as de,w as H,o as re,c as a,g as e,H as m,T as o,a2 as r,W as z,a1 as A,G as ce,B as g,a7 as N,z as k,s as ue,e as n,A as b,V as w,aa as ge,J as pe,ab as ve,a9 as me,Z as ke,j as be,a as _e,_ as he}from"./index-BRtV-TUT.js";import{u as Se,f as fe,g as ye,h as p,M as Ce,C as O,i as we,S as Te,l as Le,D as Fe,j as Me,k as Re,e as De}from"./DocumentToolDialog-C-dM8z94.js";import{u as Ve}from"./github-dark-BOB3D79E.js";const Be={class:"mobile-container"},Ie={class:"sidebar-header"},$e={class:"user-info"},xe={key:0,class:"avatar"},Pe=["src"],Ue={key:1,class:"avatar"},Ee={class:"username"},He={class:"action-area"},ze={class:"recent-chats"},Ae={class:"section-title"},Ne=["onClick"],Oe={class:"action-menu"},je=["onClick"],Ge=["onClick"],Je={class:"sidebar-footer"},We={class:"footer-btn"},Xe={class:"mobile-header"},Ze={class:"left"},qe={class:"right"},Ke={key:0,class:"user-actions"},Qe={class:"mobile-content"},Ye={key:0,class:"chat-layout"},es={class:"chat-footer"},ss={key:1,class:"welcome-wrapper"},is={class:"greeting"},os={class:"input-area-wrapper"},ns={class:"skills-grid"},ls=["onClick"],ts=["innerHTML"],as={class:"skill-label"},ds=te({__name:"Home",setup(rs){_e();const c=ae(),l=Ve(),v=de(),{isListening:T,result:j,toggleListening:L}=Se(),{uploadedFiles:_,showViewer:G,previewUrlList:J,initialIndex:W,handleFileSelect:F,removeFile:M,handlePreview:R,closeViewer:X,clearFiles:Z}=Me(),{allSkills:q,activeSkill:h,removeSkill:D}=Re(),{isLoadingHistory:K,loadConversations:Q,handleSwitchSession:Y,handleRenameConversation:ee,handleDeleteConversation:se}=fe(),{inputMessage:u,isDeepThinking:V,showSimilarityDialog:S,showMeetingRecorder:B,showDocumentDialog:f,handleSkillSelect:ie,toggleDeepThinking:I,handleLogin:$,handleLogout:x,handleStop:P}=ye(),U=be(null);H(()=>l.messages,()=>{U.value?.scrollToBottom()},{deep:!0});const E=async()=>{const t=u.value.trim();if(!t&&_.value.length===0||l.isSending)return;const s=[..._.value],d=h.value;u.value="",Z(),h.value=null,await l.sendMessage(t,s,d)};H(j,t=>{t&&(u.value=t)}),re(async()=>{await v.init(),v.isLoggedIn&&Q()});const oe=ue(()=>{const t=l.sessions.map(d=>({id:d.id,title:d.title,type:"local"})),s=l.difyConversations.map(d=>({id:d.id,title:d.name||"æ–°å¯¹è¯",type:"dify"}));return[...t,...s]}),ne=t=>{t.type==="local"?l.switchSession(t.id):Y(t.id),c.closeMobileSidebar()};return(t,s)=>{const d=pe,le=De;return n(),a("div",Be,[e(c).isMobileSidebarOpen?(n(),a("div",{key:0,class:"sidebar-mask",onClick:s[0]||(s[0]=(...i)=>e(c).closeMobileSidebar&&e(c).closeMobileSidebar(...i))})):m("",!0),o("aside",{class:ce(["mobile-sidebar",{open:e(c).isMobileSidebarOpen}])},[o("div",Ie,[o("div",$e,[e(v).avatar?(n(),a("div",xe,[o("img",{src:e(v).avatar,alt:"Avatar"},null,8,Pe)])):(n(),a("div",Ue,"ðŸ‘©â€ðŸ’»")),o("span",Ee,r(e(v).isLoggedIn?e(v).username:e(p).sidebar.usernameFallback),1)]),o("button",{class:"close-btn",onClick:s[1]||(s[1]=(...i)=>e(c).closeMobileSidebar&&e(c).closeMobileSidebar(...i))},r(e(p).sidebar.closeBtn),1)]),o("div",He,[o("button",{class:"new-chat-btn",onClick:s[2]||(s[2]=i=>e(l).createSession())},r(e(p).sidebar.newChatBtn),1)]),o("div",ze,[o("div",Ae,r(e(p).sidebar.recentSectionTitle),1),(n(!0),a(z,null,A(oe.value,i=>(n(),a("div",{key:`${i.type}-${i.id}`,class:"chat-item",onClick:y=>ne(i)},[o("span",null,r(i.title),1),i.type==="dify"?(n(),k(le,{key:0,placement:"left",trigger:"click",width:180,"popper-class":"mobile-action-popover"},{reference:b(()=>[o("button",{class:"mini-icon-btn",onClick:s[3]||(s[3]=w(()=>{},["stop"]))},[g(d,null,{default:b(()=>[g(e(me))]),_:1})])]),default:b(()=>[o("div",Oe,[o("button",{class:"menu-item",onClick:w(y=>e(ee)(e(l).difyConversations.find(C=>C.id===i.id)),["stop"])},[g(d,null,{default:b(()=>[g(e(ge))]),_:1}),s[13]||(s[13]=o("span",null,"é‡å‘½å",-1))],8,je),o("button",{class:"menu-item danger",onClick:w(y=>e(se)(e(l).difyConversations.find(C=>C.id===i.id)),["stop"])},[g(d,null,{default:b(()=>[g(e(ve))]),_:1}),s[14]||(s[14]=o("span",null,"åˆ é™¤",-1))],8,Ge)])]),_:2},1024)):m("",!0)],8,Ne))),128))]),o("div",Je,[o("button",We,r(e(p).sidebar.aboutBtn),1)])],2),o("header",Xe,[o("div",Ze,[o("button",{class:"icon-btn",onClick:s[4]||(s[4]=(...i)=>e(c).toggleMobileSidebar&&e(c).toggleMobileSidebar(...i))},"â˜°"),o("button",{class:"new-chat-pill",onClick:s[5]||(s[5]=i=>e(l).createSession())},r(e(p).header.newChatPill),1)]),o("div",qe,[e(v).isLoggedIn?(n(),a("div",Ke,[o("button",{class:"logout-btn",onClick:s[6]||(s[6]=(...i)=>e(x)&&e(x)(...i))},r(e(p).header.logout),1)])):(n(),a("button",{key:1,class:"login-btn",onClick:s[7]||(s[7]=(...i)=>e($)&&e($)(...i))},r(e(p).header.login),1))])]),o("main",Qe,[e(l).messages.length>0||e(K)?(n(),a("div",Ye,[g(e(Ce),{messages:e(l).messages,ref_key:"messageListRef",ref:U},null,8,["messages"]),o("div",es,[g(e(O),{modelValue:e(u),"onUpdate:modelValue":s[8]||(s[8]=i=>N(u)?u.value=i:null),"is-sending":e(l).isSending,"is-deep-thinking":e(V),"active-skill":e(h),"uploaded-files":e(_),"is-listening":e(T),onSend:E,onStop:e(P),onToggleDeepThink:e(I),onToggleListening:e(L),onRemoveSkill:e(D),onFileSelect:e(F),onRemoveFile:e(M),onPreviewFile:e(R)},null,8,["modelValue","is-sending","is-deep-thinking","active-skill","uploaded-files","is-listening","onStop","onToggleDeepThink","onToggleListening","onRemoveSkill","onFileSelect","onRemoveFile","onPreviewFile"])])])):(n(),a("div",ss,[o("h1",is,r(e(p).welcomeTitle),1),o("div",os,[g(e(O),{modelValue:e(u),"onUpdate:modelValue":s[9]||(s[9]=i=>N(u)?u.value=i:null),"is-sending":e(l).isSending,"is-deep-thinking":e(V),"active-skill":e(h),"uploaded-files":e(_),"is-listening":e(T),onSend:E,onStop:e(P),onToggleDeepThink:e(I),onToggleListening:e(L),onRemoveSkill:e(D),onFileSelect:e(F),onRemoveFile:e(M),onPreviewFile:e(R)},null,8,["modelValue","is-sending","is-deep-thinking","active-skill","uploaded-files","is-listening","onStop","onToggleDeepThink","onToggleListening","onRemoveSkill","onFileSelect","onRemoveFile","onPreviewFile"])]),o("div",ns,[(n(!0),a(z,null,A(e(q),i=>(n(),a("div",{key:i.label,class:"skill-item",onClick:y=>e(ie)(i)},[o("div",{class:"skill-icon-wrapper",style:ke({color:i.color})},[o("span",{class:"skill-icon",innerHTML:i.icon},null,8,ts)],4),o("span",as,r(i.label),1)],8,ls))),128))])]))]),e(G)?(n(),k(e(we),{key:1,"url-list":e(J),"initial-index":e(W),onClose:e(X)},null,8,["url-list","initial-index","onClose"])):m("",!0),e(S)?(n(),k(Te,{key:2,visible:e(S),"onUpdate:visible":s[10]||(s[10]=i=>S.value=i)},null,8,["visible"])):m("",!0),e(B)?(n(),k(Le,{key:3,onClose:s[11]||(s[11]=i=>B.value=!1)})):m("",!0),e(f)?(n(),k(Fe,{key:4,visible:e(f),"onUpdate:visible":s[12]||(s[12]=i=>f.value=i)},null,8,["visible"])):m("",!0)])}}}),ps=he(ds,[["__scopeId","data-v-9638aea9"]]);export{ps as default};
